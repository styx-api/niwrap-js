// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const MRFILTER_METADATA: Metadata = {
    id: "a47cabbb6dd1bf7eda885d594a87568625b0abbc.boutiques",
    name: "mrfilter",
    package: "mrtrix",
    container_image_tag: "mrtrix3/mrtrix3:3.0.4",
};


interface MrfilterVariousStringParameters {
    "@type"?: "VariousString";
    "obj": string;
}
type MrfilterVariousStringParametersTagged = Required<Pick<MrfilterVariousStringParameters, '@type'>> & MrfilterVariousStringParameters;


interface MrfilterVariousFileParameters {
    "@type"?: "VariousFile";
    "obj": InputPathType;
}
type MrfilterVariousFileParametersTagged = Required<Pick<MrfilterVariousFileParameters, '@type'>> & MrfilterVariousFileParameters;


interface MrfilterConfigParameters {
    "@type"?: "config";
    "key": string;
    "value": string;
}
type MrfilterConfigParametersTagged = Required<Pick<MrfilterConfigParameters, '@type'>> & MrfilterConfigParameters;


interface MrfilterParameters {
    "@type"?: "mrtrix/mrfilter";
    "axes"?: Array<number> | null | undefined;
    "inverse": boolean;
    "magnitude": boolean;
    "centre_zero": boolean;
    "stdev"?: Array<number> | null | undefined;
    "magnitude_1": boolean;
    "scanner": boolean;
    "extent"?: Array<number> | null | undefined;
    "extent_1"?: Array<number> | null | undefined;
    "stdev_1"?: Array<number> | null | undefined;
    "fwhm"?: Array<number> | null | undefined;
    "extent_2"?: Array<number> | null | undefined;
    "zupper"?: number | null | undefined;
    "zlower"?: number | null | undefined;
    "bridge"?: number | null | undefined;
    "maskin"?: InputPathType | null | undefined;
    "maskout"?: string | null | undefined;
    "strides"?: MrfilterVariousStringParametersTagged | MrfilterVariousFileParametersTagged | null | undefined;
    "info": boolean;
    "quiet": boolean;
    "debug": boolean;
    "force": boolean;
    "nthreads"?: number | null | undefined;
    "config"?: Array<MrfilterConfigParameters> | null | undefined;
    "help": boolean;
    "version": boolean;
    "input": InputPathType;
    "filter": string;
    "output": string;
}
type MrfilterParametersTagged = Required<Pick<MrfilterParameters, '@type'>> & MrfilterParameters;


/**
 * Get build cargs function by command type.
 *
 * @param t Command type
 *
 * @returns Build cargs function.
 */
function mrfilter_strides_cargs_dyn_fn(
    t: string,
): Function | undefined {
    const cargsFuncs = {
        "VariousString": mrfilter_various_string_cargs,
        "VariousFile": mrfilter_various_file_cargs,
    };
    return cargsFuncs[t];
}


/**
 * Get build outputs function by command type.
 *
 * @param t Command type
 *
 * @returns Build outputs function.
 */
function mrfilter_strides_outputs_dyn_fn(
    t: string,
): Function | undefined {
    const outputsFuncs = {
    };
    return outputsFuncs[t];
}


/**
 * Build parameters.
 *
 * @param obj String object.
 *
 * @returns Parameter dictionary
 */
function mrfilter_various_string_params(
    obj: string,
): MrfilterVariousStringParametersTagged {
    const params = {
        "@type": "VariousString" as const,
        "obj": obj,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function mrfilter_various_string_cargs(
    params: MrfilterVariousStringParameters,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push((params["obj"] ?? null));
    return cargs;
}


/**
 * Build parameters.
 *
 * @param obj File object.
 *
 * @returns Parameter dictionary
 */
function mrfilter_various_file_params(
    obj: InputPathType,
): MrfilterVariousFileParametersTagged {
    const params = {
        "@type": "VariousFile" as const,
        "obj": obj,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function mrfilter_various_file_cargs(
    params: MrfilterVariousFileParameters,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(execution.inputFile((params["obj"] ?? null)));
    return cargs;
}


/**
 * Build parameters.
 *
 * @param key temporarily set the value of an MRtrix config file entry.
 * @param value temporarily set the value of an MRtrix config file entry.
 *
 * @returns Parameter dictionary
 */
function mrfilter_config_params(
    key: string,
    value: string,
): MrfilterConfigParametersTagged {
    const params = {
        "@type": "config" as const,
        "key": key,
        "value": value,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function mrfilter_config_cargs(
    params: MrfilterConfigParameters,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push("-config");
    cargs.push((params["key"] ?? null));
    cargs.push((params["value"] ?? null));
    return cargs;
}


/**
 * Output object returned when calling `MrfilterParameters(...)`.
 *
 * @interface
 */
interface MrfilterOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * the output image.
     */
    output: OutputPathType;
    /**
     * Output a refined mask based on a spatially coherent region with normal intensity range. 
     */
    maskout: OutputPathType | null;
}


/**
 * Build parameters.
 *
 * @param input the input image.
 * @param filter the type of filter to be applied
 * @param output the output image.
 * @param axes the axes along which to apply the Fourier Transform. By default, the transform is applied along the three spatial axes. Provide as a comma-separate list of axis indices.
 * @param inverse apply the inverse FFT
 * @param magnitude output a magnitude image rather than a complex-valued image
 * @param centre_zero re-arrange the FFT results so that the zero-frequency component appears in the centre of the image, rather than at the edges
 * @param stdev the standard deviation of the Gaussian kernel used to smooth the input image (in mm). The image is smoothed to reduced large spurious gradients caused by noise. Use this option to override the default stdev of 1 voxel. This can be specified either as a single value to be used for all 3 axes, or as a comma-separated list of 3 values, one for each axis.
 * @param magnitude_1 output the gradient magnitude, rather than the default x,y,z components
 * @param scanner define the gradient with respect to the scanner coordinate frame of reference.
 * @param extent specify extent of median filtering neighbourhood in voxels. This can be specified either as a single value to be used for all 3 axes, or as a comma-separated list of 3 values, one for each axis (default: 3x3x3).
 * @param extent_1 specify extent of normalisation filtering neighbourhood in voxels. This can be specified either as a single value to be used for all 3 axes, or as a comma-separated list of 3 values, one for each axis (default: 3x3x3).
 * @param stdev_1 apply Gaussian smoothing with the specified standard deviation. The standard deviation is defined in mm (Default 1 voxel). This can be specified either as a single value to be used for all axes, or as a comma-separated list of the stdev for each axis.
 * @param fwhm apply Gaussian smoothing with the specified full-width half maximum. The FWHM is defined in mm (Default 1 voxel * 2.3548). This can be specified either as a single value to be used for all axes, or as a comma-separated list of the FWHM for each axis.
 * @param extent_2 specify the extent (width) of kernel size in voxels. This can be specified either as a single value to be used for all axes, or as a comma-separated list of the extent for each axis. The default extent is 2 * ceil(2.5 * stdev / voxel_size) - 1.
 * @param zupper define high intensity outliers: default: 2.5
 * @param zlower define low intensity outliers: default: 2.5
 * @param bridge number of voxels to gap to fill holes in mask: default: 4
 * @param maskin initial mask that defines the maximum spatial extent and the region from which to smaple the intensity range.
 * @param maskout Output a refined mask based on a spatially coherent region with normal intensity range.
 * @param strides specify the strides of the output data in memory; either as a comma-separated list of (signed) integers, or as a template image from which the strides shall be extracted and used. The actual strides produced will depend on whether the output image format can support it.
 * @param info display information messages.
 * @param quiet do not display information messages or progress status; alternatively, this can be achieved by setting the MRTRIX_QUIET environment variable to a non-empty string.
 * @param debug display debugging messages.
 * @param force force overwrite of output files (caution: using the same file as input and output might cause unexpected behaviour).
 * @param nthreads use this number of threads in multi-threaded applications (set to 0 to disable multi-threading).
 * @param config temporarily set the value of an MRtrix config file entry.
 * @param help display this information page and exit.
 * @param version display version information and exit.
 *
 * @returns Parameter dictionary
 */
function mrfilter_params(
    input: InputPathType,
    filter: string,
    output: string,
    axes: Array<number> | null = null,
    inverse: boolean = false,
    magnitude: boolean = false,
    centre_zero: boolean = false,
    stdev: Array<number> | null = null,
    magnitude_1: boolean = false,
    scanner: boolean = false,
    extent: Array<number> | null = null,
    extent_1: Array<number> | null = null,
    stdev_1: Array<number> | null = null,
    fwhm: Array<number> | null = null,
    extent_2: Array<number> | null = null,
    zupper: number | null = null,
    zlower: number | null = null,
    bridge: number | null = null,
    maskin: InputPathType | null = null,
    maskout: string | null = null,
    strides: MrfilterVariousStringParametersTagged | MrfilterVariousFileParametersTagged | null = null,
    info: boolean = false,
    quiet: boolean = false,
    debug: boolean = false,
    force: boolean = false,
    nthreads: number | null = null,
    config: Array<MrfilterConfigParameters> | null = null,
    help: boolean = false,
    version: boolean = false,
): MrfilterParametersTagged {
    const params = {
        "@type": "mrtrix/mrfilter" as const,
        "inverse": inverse,
        "magnitude": magnitude,
        "centre_zero": centre_zero,
        "magnitude_1": magnitude_1,
        "scanner": scanner,
        "info": info,
        "quiet": quiet,
        "debug": debug,
        "force": force,
        "help": help,
        "version": version,
        "input": input,
        "filter": filter,
        "output": output,
    };
    if (axes !== null) {
        params["axes"] = axes;
    }
    if (stdev !== null) {
        params["stdev"] = stdev;
    }
    if (extent !== null) {
        params["extent"] = extent;
    }
    if (extent_1 !== null) {
        params["extent_1"] = extent_1;
    }
    if (stdev_1 !== null) {
        params["stdev_1"] = stdev_1;
    }
    if (fwhm !== null) {
        params["fwhm"] = fwhm;
    }
    if (extent_2 !== null) {
        params["extent_2"] = extent_2;
    }
    if (zupper !== null) {
        params["zupper"] = zupper;
    }
    if (zlower !== null) {
        params["zlower"] = zlower;
    }
    if (bridge !== null) {
        params["bridge"] = bridge;
    }
    if (maskin !== null) {
        params["maskin"] = maskin;
    }
    if (maskout !== null) {
        params["maskout"] = maskout;
    }
    if (strides !== null) {
        params["strides"] = strides;
    }
    if (nthreads !== null) {
        params["nthreads"] = nthreads;
    }
    if (config !== null) {
        params["config"] = config;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function mrfilter_cargs(
    params: MrfilterParameters,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push("mrfilter");
    if ((params["axes"] ?? null) !== null) {
        cargs.push(
            "-axes",
            ...(params["axes"] ?? null).map(String)
        );
    }
    if ((params["inverse"] ?? false)) {
        cargs.push("-inverse");
    }
    if ((params["magnitude"] ?? false)) {
        cargs.push("-magnitude");
    }
    if ((params["centre_zero"] ?? false)) {
        cargs.push("-centre_zero");
    }
    if ((params["stdev"] ?? null) !== null) {
        cargs.push(
            "-stdev",
            (params["stdev"] ?? null).map(String).join(",")
        );
    }
    if ((params["magnitude_1"] ?? false)) {
        cargs.push("-magnitude");
    }
    if ((params["scanner"] ?? false)) {
        cargs.push("-scanner");
    }
    if ((params["extent"] ?? null) !== null) {
        cargs.push(
            "-extent",
            (params["extent"] ?? null).map(String).join(",")
        );
    }
    if ((params["extent_1"] ?? null) !== null) {
        cargs.push(
            "-extent",
            (params["extent_1"] ?? null).map(String).join(",")
        );
    }
    if ((params["stdev_1"] ?? null) !== null) {
        cargs.push(
            "-stdev",
            (params["stdev_1"] ?? null).map(String).join(",")
        );
    }
    if ((params["fwhm"] ?? null) !== null) {
        cargs.push(
            "-fwhm",
            (params["fwhm"] ?? null).map(String).join(",")
        );
    }
    if ((params["extent_2"] ?? null) !== null) {
        cargs.push(
            "-extent",
            (params["extent_2"] ?? null).map(String).join(",")
        );
    }
    if ((params["zupper"] ?? null) !== null) {
        cargs.push(
            "-zupper",
            String((params["zupper"] ?? null))
        );
    }
    if ((params["zlower"] ?? null) !== null) {
        cargs.push(
            "-zlower",
            String((params["zlower"] ?? null))
        );
    }
    if ((params["bridge"] ?? null) !== null) {
        cargs.push(
            "-bridge",
            String((params["bridge"] ?? null))
        );
    }
    if ((params["maskin"] ?? null) !== null) {
        cargs.push(
            "-maskin",
            execution.inputFile((params["maskin"] ?? null))
        );
    }
    if ((params["maskout"] ?? null) !== null) {
        cargs.push(
            "-maskout",
            (params["maskout"] ?? null)
        );
    }
    if ((params["strides"] ?? null) !== null) {
        cargs.push(
            "-strides",
            ...mrfilter_strides_cargs_dyn_fn((params["strides"] ?? null)["@type"])((params["strides"] ?? null), execution)
        );
    }
    if ((params["info"] ?? false)) {
        cargs.push("-info");
    }
    if ((params["quiet"] ?? false)) {
        cargs.push("-quiet");
    }
    if ((params["debug"] ?? false)) {
        cargs.push("-debug");
    }
    if ((params["force"] ?? false)) {
        cargs.push("-force");
    }
    if ((params["nthreads"] ?? null) !== null) {
        cargs.push(
            "-nthreads",
            String((params["nthreads"] ?? null))
        );
    }
    if ((params["config"] ?? null) !== null) {
        cargs.push(...(params["config"] ?? null).map(s => mrfilter_config_cargs(s, execution)).flat());
    }
    if ((params["help"] ?? false)) {
        cargs.push("-help");
    }
    if ((params["version"] ?? false)) {
        cargs.push("-version");
    }
    cargs.push(execution.inputFile((params["input"] ?? null)));
    cargs.push((params["filter"] ?? null));
    cargs.push((params["output"] ?? null));
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function mrfilter_outputs(
    params: MrfilterParameters,
    execution: Execution,
): MrfilterOutputs {
    const ret: MrfilterOutputs = {
        root: execution.outputFile("."),
        output: execution.outputFile([(params["output"] ?? null)].join('')),
        maskout: ((params["maskout"] ?? null) !== null) ? execution.outputFile([(params["maskout"] ?? null)].join('')) : null,
    };
    return ret;
}


/**
 * mrfilter
 *
 * Perform filtering operations on 3D / 4D MR images.
 *
 * The available filters are: fft, gradient, median, smooth, normalise, zclean.
 *
 * Each filter has its own unique set of optional parameters.
 *
 * For 4D images, each 3D volume is processed independently.
 *
 * References:
 *
 * .
 *
 * Author: MRTrix3 Developers
 *
 * URL: https://www.mrtrix.org/
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `MrfilterOutputs`).
 */
function mrfilter_execute(
    params: MrfilterParameters,
    runner: Runner | null = null,
): MrfilterOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(MRFILTER_METADATA);
    params = execution.params(params)
    const cargs = mrfilter_cargs(params, execution)
    const ret = mrfilter_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * mrfilter
 *
 * Perform filtering operations on 3D / 4D MR images.
 *
 * The available filters are: fft, gradient, median, smooth, normalise, zclean.
 *
 * Each filter has its own unique set of optional parameters.
 *
 * For 4D images, each 3D volume is processed independently.
 *
 * References:
 *
 * .
 *
 * Author: MRTrix3 Developers
 *
 * URL: https://www.mrtrix.org/
 *
 * @param input the input image.
 * @param filter the type of filter to be applied
 * @param output the output image.
 * @param axes the axes along which to apply the Fourier Transform. By default, the transform is applied along the three spatial axes. Provide as a comma-separate list of axis indices.
 * @param inverse apply the inverse FFT
 * @param magnitude output a magnitude image rather than a complex-valued image
 * @param centre_zero re-arrange the FFT results so that the zero-frequency component appears in the centre of the image, rather than at the edges
 * @param stdev the standard deviation of the Gaussian kernel used to smooth the input image (in mm). The image is smoothed to reduced large spurious gradients caused by noise. Use this option to override the default stdev of 1 voxel. This can be specified either as a single value to be used for all 3 axes, or as a comma-separated list of 3 values, one for each axis.
 * @param magnitude_1 output the gradient magnitude, rather than the default x,y,z components
 * @param scanner define the gradient with respect to the scanner coordinate frame of reference.
 * @param extent specify extent of median filtering neighbourhood in voxels. This can be specified either as a single value to be used for all 3 axes, or as a comma-separated list of 3 values, one for each axis (default: 3x3x3).
 * @param extent_1 specify extent of normalisation filtering neighbourhood in voxels. This can be specified either as a single value to be used for all 3 axes, or as a comma-separated list of 3 values, one for each axis (default: 3x3x3).
 * @param stdev_1 apply Gaussian smoothing with the specified standard deviation. The standard deviation is defined in mm (Default 1 voxel). This can be specified either as a single value to be used for all axes, or as a comma-separated list of the stdev for each axis.
 * @param fwhm apply Gaussian smoothing with the specified full-width half maximum. The FWHM is defined in mm (Default 1 voxel * 2.3548). This can be specified either as a single value to be used for all axes, or as a comma-separated list of the FWHM for each axis.
 * @param extent_2 specify the extent (width) of kernel size in voxels. This can be specified either as a single value to be used for all axes, or as a comma-separated list of the extent for each axis. The default extent is 2 * ceil(2.5 * stdev / voxel_size) - 1.
 * @param zupper define high intensity outliers: default: 2.5
 * @param zlower define low intensity outliers: default: 2.5
 * @param bridge number of voxels to gap to fill holes in mask: default: 4
 * @param maskin initial mask that defines the maximum spatial extent and the region from which to smaple the intensity range.
 * @param maskout Output a refined mask based on a spatially coherent region with normal intensity range.
 * @param strides specify the strides of the output data in memory; either as a comma-separated list of (signed) integers, or as a template image from which the strides shall be extracted and used. The actual strides produced will depend on whether the output image format can support it.
 * @param info display information messages.
 * @param quiet do not display information messages or progress status; alternatively, this can be achieved by setting the MRTRIX_QUIET environment variable to a non-empty string.
 * @param debug display debugging messages.
 * @param force force overwrite of output files (caution: using the same file as input and output might cause unexpected behaviour).
 * @param nthreads use this number of threads in multi-threaded applications (set to 0 to disable multi-threading).
 * @param config temporarily set the value of an MRtrix config file entry.
 * @param help display this information page and exit.
 * @param version display version information and exit.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `MrfilterOutputs`).
 */
function mrfilter(
    input: InputPathType,
    filter: string,
    output: string,
    axes: Array<number> | null = null,
    inverse: boolean = false,
    magnitude: boolean = false,
    centre_zero: boolean = false,
    stdev: Array<number> | null = null,
    magnitude_1: boolean = false,
    scanner: boolean = false,
    extent: Array<number> | null = null,
    extent_1: Array<number> | null = null,
    stdev_1: Array<number> | null = null,
    fwhm: Array<number> | null = null,
    extent_2: Array<number> | null = null,
    zupper: number | null = null,
    zlower: number | null = null,
    bridge: number | null = null,
    maskin: InputPathType | null = null,
    maskout: string | null = null,
    strides: MrfilterVariousStringParametersTagged | MrfilterVariousFileParametersTagged | null = null,
    info: boolean = false,
    quiet: boolean = false,
    debug: boolean = false,
    force: boolean = false,
    nthreads: number | null = null,
    config: Array<MrfilterConfigParameters> | null = null,
    help: boolean = false,
    version: boolean = false,
    runner: Runner | null = null,
): MrfilterOutputs {
    const params = mrfilter_params(input, filter, output, axes, inverse, magnitude, centre_zero, stdev, magnitude_1, scanner, extent, extent_1, stdev_1, fwhm, extent_2, zupper, zlower, bridge, maskin, maskout, strides, info, quiet, debug, force, nthreads, config, help, version)
    return mrfilter_execute(params, runner);
}


export {
      MRFILTER_METADATA,
      MrfilterOutputs,
      mrfilter,
      mrfilter_config_params,
      mrfilter_execute,
      mrfilter_params,
      mrfilter_various_file_params,
      mrfilter_various_string_params,
};
