// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const FIBER_DOT_PRODUCTS_METADATA: Metadata = {
    id: "59c62ac73c0dcf4d07840b26ea3183b46e8c89ab.workbench",
    name: "fiber-dot-products",
    package: "workbench",
    container_image_tag: "nx10x/workbench:2.1.0",
};


interface FiberDotProductsParamsDict {
    "@type"?: "workbench/fiber-dot-products";
    "dot-metric": string;
    "f-metric": string;
    "white-surf": InputPathType;
    "fiber-file": InputPathType;
    "max-dist": number;
    "direction": string;
}
type FiberDotProductsParamsDictTagged = Required<Pick<FiberDotProductsParamsDict, '@type'>> & FiberDotProductsParamsDict;


/**
 * Output object returned when calling `FiberDotProductsParamsDict(...)`.
 *
 * @interface
 */
interface FiberDotProductsOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * the metric of dot products
     */
    dot_metric: OutputPathType;
    /**
     * a metric of the f values of the fiber distributions
     */
    f_metric: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param dot_metric the metric of dot products
 * @param f_metric a metric of the f values of the fiber distributions
 * @param white_surf the white/gray boundary surface
 * @param fiber_file the fiber orientation file
 * @param max_dist the maximum distance from any surface vertex a fiber population may be, in mm
 * @param direction test against surface for whether a fiber population should be used
 *
 * @returns Parameter dictionary
 */
function fiber_dot_products_params(
    dot_metric: string,
    f_metric: string,
    white_surf: InputPathType,
    fiber_file: InputPathType,
    max_dist: number,
    direction: string,
): FiberDotProductsParamsDictTagged {
    const params = {
        "@type": "workbench/fiber-dot-products" as const,
        "dot-metric": dot_metric,
        "f-metric": f_metric,
        "white-surf": white_surf,
        "fiber-file": fiber_file,
        "max-dist": max_dist,
        "direction": direction,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function fiber_dot_products_cargs(
    params: FiberDotProductsParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "wb_command",
        "-fiber-dot-products",
        (params["dot-metric"] ?? null),
        (params["f-metric"] ?? null)
    );
    cargs.push(execution.inputFile((params["white-surf"] ?? null)));
    cargs.push(execution.inputFile((params["fiber-file"] ?? null)));
    cargs.push(String((params["max-dist"] ?? null)));
    cargs.push((params["direction"] ?? null));
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function fiber_dot_products_outputs(
    params: FiberDotProductsParamsDict,
    execution: Execution,
): FiberDotProductsOutputs {
    const ret: FiberDotProductsOutputs = {
        root: execution.outputFile("."),
        dot_metric: execution.outputFile([(params["dot-metric"] ?? null)].join('')),
        f_metric: execution.outputFile([(params["f-metric"] ?? null)].join('')),
    };
    return ret;
}


/**
 * COMPUTE DOT PRODUCTS OF FIBER ORIENTATIONS WITH SURFACE NORMALS.
 *
 * For each vertex, this command finds the closest fiber population that satisfies the <direction> test, and computes the absolute value of the dot product of the surface normal and the normalized mean direction of each fiber.  The <direction> test must be one of INSIDE, OUTSIDE, or ANY, which causes the command to only use fiber populations that are inside the surface, outside the surface, or to not care which direction it is from the surface.  Each fiber population is output in a separate metric column.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `FiberDotProductsOutputs`).
 */
function fiber_dot_products_execute(
    params: FiberDotProductsParamsDict,
    runner: Runner | null = null,
): FiberDotProductsOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(FIBER_DOT_PRODUCTS_METADATA);
    params = execution.params(params)
    const cargs = fiber_dot_products_cargs(params, execution)
    const ret = fiber_dot_products_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * COMPUTE DOT PRODUCTS OF FIBER ORIENTATIONS WITH SURFACE NORMALS.
 *
 * For each vertex, this command finds the closest fiber population that satisfies the <direction> test, and computes the absolute value of the dot product of the surface normal and the normalized mean direction of each fiber.  The <direction> test must be one of INSIDE, OUTSIDE, or ANY, which causes the command to only use fiber populations that are inside the surface, outside the surface, or to not care which direction it is from the surface.  Each fiber population is output in a separate metric column.
 *
 * @param dot_metric the metric of dot products
 * @param f_metric a metric of the f values of the fiber distributions
 * @param white_surf the white/gray boundary surface
 * @param fiber_file the fiber orientation file
 * @param max_dist the maximum distance from any surface vertex a fiber population may be, in mm
 * @param direction test against surface for whether a fiber population should be used
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `FiberDotProductsOutputs`).
 */
function fiber_dot_products(
    dot_metric: string,
    f_metric: string,
    white_surf: InputPathType,
    fiber_file: InputPathType,
    max_dist: number,
    direction: string,
    runner: Runner | null = null,
): FiberDotProductsOutputs {
    const params = fiber_dot_products_params(dot_metric, f_metric, white_surf, fiber_file, max_dist, direction)
    return fiber_dot_products_execute(params, runner);
}


export {
      FIBER_DOT_PRODUCTS_METADATA,
      FiberDotProductsOutputs,
      FiberDotProductsParamsDict,
      FiberDotProductsParamsDictTagged,
      fiber_dot_products,
      fiber_dot_products_execute,
      fiber_dot_products_params,
};
