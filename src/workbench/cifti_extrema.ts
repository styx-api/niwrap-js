// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const CIFTI_EXTREMA_METADATA: Metadata = {
    id: "96cc4edc754b1196eb76c4a8761c2b9a9cc4593f.workbench",
    name: "cifti-extrema",
    package: "workbench",
    container_image_tag: "nx10x/workbench:2.1.0",
};


interface CiftiExtremaThresholdParamsDict {
    "@type"?: "threshold";
    "low": number;
    "high": number;
}
type CiftiExtremaThresholdParamsDictTagged = Required<Pick<CiftiExtremaThresholdParamsDict, '@type'>> & CiftiExtremaThresholdParamsDict;


interface CiftiExtremaParamsDict {
    "@type"?: "workbench/cifti-extrema";
    "cifti-out": string;
    "surface"?: InputPathType | null | undefined;
    "surface"?: InputPathType | null | undefined;
    "surface"?: InputPathType | null | undefined;
    "surface-kernel"?: number | null | undefined;
    "volume-kernel"?: number | null | undefined;
    "presmooth-fwhm": boolean;
    "threshold"?: CiftiExtremaThresholdParamsDict | null | undefined;
    "merged-volume": boolean;
    "sum-maps": boolean;
    "consolidate-mode": boolean;
    "only-maxima": boolean;
    "only-minima": boolean;
    "cifti": InputPathType;
    "surface-distance": number;
    "volume-distance": number;
    "direction": string;
}
type CiftiExtremaParamsDictTagged = Required<Pick<CiftiExtremaParamsDict, '@type'>> & CiftiExtremaParamsDict;


/**
 * Build parameters.
 *
 * @param low the largest value to consider for being a minimum
 * @param high the smallest value to consider for being a maximum
 *
 * @returns Parameter dictionary
 */
function cifti_extrema_threshold(
    low: number,
    high: number,
): CiftiExtremaThresholdParamsDictTagged {
    const params = {
        "@type": "threshold" as const,
        "low": low,
        "high": high,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_extrema_threshold_cargs(
    params: CiftiExtremaThresholdParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "-threshold",
        String((params["low"] ?? null)),
        String((params["high"] ?? null))
    );
    return cargs;
}


/**
 * Output object returned when calling `CiftiExtremaParamsDict(...)`.
 *
 * @interface
 */
interface CiftiExtremaOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * the output cifti
     */
    cifti_out: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param cifti_out the output cifti
 * @param cifti the input cifti
 * @param surface_distance the minimum distance between extrema of the same type, for surface components
 * @param volume_distance the minimum distance between extrema of the same type, for volume components
 * @param direction which dimension to find extrema along, ROW or COLUMN
 * @param surface specify the left surface to use

the left surface file
 * @param surface_ specify the right surface to use

the right surface file
 * @param surface_2 specify the cerebellum surface to use

the cerebellum surface file
 * @param surface_kernel smooth on the surface before finding extrema

the size of the gaussian surface smoothing kernel in mm, as sigma by default
 * @param volume_kernel smooth volume components before finding extrema

the size of the gaussian volume smoothing kernel in mm, as sigma by default
 * @param presmooth_fwhm smoothing kernel distances are FWHM, not sigma
 * @param threshold ignore small extrema
 * @param merged_volume treat volume components as if they were a single component
 * @param sum_maps output the sum of the extrema maps instead of each map separately
 * @param consolidate_mode use consolidation of local minima instead of a large neighborhood
 * @param only_maxima only find the maxima
 * @param only_minima only find the minima
 *
 * @returns Parameter dictionary
 */
function cifti_extrema_params(
    cifti_out: string,
    cifti: InputPathType,
    surface_distance: number,
    volume_distance: number,
    direction: string,
    surface: InputPathType | null = null,
    surface_: InputPathType | null = null,
    surface_2: InputPathType | null = null,
    surface_kernel: number | null = null,
    volume_kernel: number | null = null,
    presmooth_fwhm: boolean = false,
    threshold: CiftiExtremaThresholdParamsDict | null = null,
    merged_volume: boolean = false,
    sum_maps: boolean = false,
    consolidate_mode: boolean = false,
    only_maxima: boolean = false,
    only_minima: boolean = false,
): CiftiExtremaParamsDictTagged {
    const params = {
        "@type": "workbench/cifti-extrema" as const,
        "cifti-out": cifti_out,
        "presmooth-fwhm": presmooth_fwhm,
        "merged-volume": merged_volume,
        "sum-maps": sum_maps,
        "consolidate-mode": consolidate_mode,
        "only-maxima": only_maxima,
        "only-minima": only_minima,
        "cifti": cifti,
        "surface-distance": surface_distance,
        "volume-distance": volume_distance,
        "direction": direction,
    };
    if (surface !== null) {
        params["surface"] = surface;
    }
    if (surface_ !== null) {
        params["surface"] = surface_;
    }
    if (surface_2 !== null) {
        params["surface"] = surface_2;
    }
    if (surface_kernel !== null) {
        params["surface-kernel"] = surface_kernel;
    }
    if (volume_kernel !== null) {
        params["volume-kernel"] = volume_kernel;
    }
    if (threshold !== null) {
        params["threshold"] = threshold;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_extrema_cargs(
    params: CiftiExtremaParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["surface"] ?? null) !== null || (params["surface"] ?? null) !== null || (params["surface"] ?? null) !== null || (params["surface-kernel"] ?? null) !== null || (params["volume-kernel"] ?? null) !== null || (params["presmooth-fwhm"] ?? false) || (params["threshold"] ?? null) !== null || (params["merged-volume"] ?? false) || (params["sum-maps"] ?? false) || (params["consolidate-mode"] ?? false) || (params["only-maxima"] ?? false) || (params["only-minima"] ?? false)) {
        cargs.push(
            "wb_command",
            "-cifti-extrema",
            (params["cifti-out"] ?? null),
            ["-left-surface", (((params["surface"] ?? null) !== null) ? execution.inputFile((params["surface"] ?? null)) : "")].join(''),
            ["-right-surface", (((params["surface"] ?? null) !== null) ? execution.inputFile((params["surface"] ?? null)) : "")].join(''),
            ["-cerebellum-surface", (((params["surface"] ?? null) !== null) ? execution.inputFile((params["surface"] ?? null)) : "")].join(''),
            ["-surface-presmooth", (((params["surface-kernel"] ?? null) !== null) ? String((params["surface-kernel"] ?? null)) : "")].join(''),
            ["-volume-presmooth", (((params["volume-kernel"] ?? null) !== null) ? String((params["volume-kernel"] ?? null)) : "")].join(''),
            (((params["presmooth-fwhm"] ?? false)) ? "-presmooth-fwhm" : ""),
            ...(((params["threshold"] ?? null) !== null) ? cifti_extrema_threshold_cargs((params["threshold"] ?? null), execution) : []),
            (((params["merged-volume"] ?? false)) ? "-merged-volume" : ""),
            (((params["sum-maps"] ?? false)) ? "-sum-maps" : ""),
            (((params["consolidate-mode"] ?? false)) ? "-consolidate-mode" : ""),
            (((params["only-maxima"] ?? false)) ? "-only-maxima" : ""),
            (((params["only-minima"] ?? false)) ? "-only-minima" : "")
        );
    }
    cargs.push(execution.inputFile((params["cifti"] ?? null)));
    cargs.push(String((params["surface-distance"] ?? null)));
    cargs.push(String((params["volume-distance"] ?? null)));
    cargs.push((params["direction"] ?? null));
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function cifti_extrema_outputs(
    params: CiftiExtremaParamsDict,
    execution: Execution,
): CiftiExtremaOutputs {
    const ret: CiftiExtremaOutputs = {
        root: execution.outputFile("."),
        cifti_out: execution.outputFile([(params["cifti-out"] ?? null)].join('')),
    };
    return ret;
}


/**
 * FIND EXTREMA IN A CIFTI FILE.
 *
 * Finds spatial locations in a cifti file that have more extreme values than all nearby locations in the same component (surface or volume structure).  The input cifti file must have a brain models mapping along the specified direction.  COLUMN is the direction that works on dtseries and dscalar.  For dconn, if it is symmetric use COLUMN, otherwise use ROW.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CiftiExtremaOutputs`).
 */
function cifti_extrema_execute(
    params: CiftiExtremaParamsDict,
    runner: Runner | null = null,
): CiftiExtremaOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(CIFTI_EXTREMA_METADATA);
    params = execution.params(params)
    const cargs = cifti_extrema_cargs(params, execution)
    const ret = cifti_extrema_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * FIND EXTREMA IN A CIFTI FILE.
 *
 * Finds spatial locations in a cifti file that have more extreme values than all nearby locations in the same component (surface or volume structure).  The input cifti file must have a brain models mapping along the specified direction.  COLUMN is the direction that works on dtseries and dscalar.  For dconn, if it is symmetric use COLUMN, otherwise use ROW.
 *
 * @param cifti_out the output cifti
 * @param cifti the input cifti
 * @param surface_distance the minimum distance between extrema of the same type, for surface components
 * @param volume_distance the minimum distance between extrema of the same type, for volume components
 * @param direction which dimension to find extrema along, ROW or COLUMN
 * @param surface specify the left surface to use

the left surface file
 * @param surface_ specify the right surface to use

the right surface file
 * @param surface_2 specify the cerebellum surface to use

the cerebellum surface file
 * @param surface_kernel smooth on the surface before finding extrema

the size of the gaussian surface smoothing kernel in mm, as sigma by default
 * @param volume_kernel smooth volume components before finding extrema

the size of the gaussian volume smoothing kernel in mm, as sigma by default
 * @param presmooth_fwhm smoothing kernel distances are FWHM, not sigma
 * @param threshold ignore small extrema
 * @param merged_volume treat volume components as if they were a single component
 * @param sum_maps output the sum of the extrema maps instead of each map separately
 * @param consolidate_mode use consolidation of local minima instead of a large neighborhood
 * @param only_maxima only find the maxima
 * @param only_minima only find the minima
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CiftiExtremaOutputs`).
 */
function cifti_extrema(
    cifti_out: string,
    cifti: InputPathType,
    surface_distance: number,
    volume_distance: number,
    direction: string,
    surface: InputPathType | null = null,
    surface_: InputPathType | null = null,
    surface_2: InputPathType | null = null,
    surface_kernel: number | null = null,
    volume_kernel: number | null = null,
    presmooth_fwhm: boolean = false,
    threshold: CiftiExtremaThresholdParamsDict | null = null,
    merged_volume: boolean = false,
    sum_maps: boolean = false,
    consolidate_mode: boolean = false,
    only_maxima: boolean = false,
    only_minima: boolean = false,
    runner: Runner | null = null,
): CiftiExtremaOutputs {
    const params = cifti_extrema_params(cifti_out, cifti, surface_distance, volume_distance, direction, surface, surface_, surface_2, surface_kernel, volume_kernel, presmooth_fwhm, threshold, merged_volume, sum_maps, consolidate_mode, only_maxima, only_minima)
    return cifti_extrema_execute(params, runner);
}


export {
      CIFTI_EXTREMA_METADATA,
      CiftiExtremaOutputs,
      CiftiExtremaParamsDict,
      CiftiExtremaParamsDictTagged,
      CiftiExtremaThresholdParamsDict,
      CiftiExtremaThresholdParamsDictTagged,
      cifti_extrema,
      cifti_extrema_execute,
      cifti_extrema_params,
      cifti_extrema_threshold,
};
