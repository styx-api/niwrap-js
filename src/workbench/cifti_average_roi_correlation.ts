// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const CIFTI_AVERAGE_ROI_CORRELATION_METADATA: Metadata = {
    id: "8675ac82eeff102d67fcb3c8cd17fa1826495162.workbench",
    name: "cifti-average-roi-correlation",
    package: "workbench",
    container_image_tag: "nx10x/workbench:2.1.0",
};


interface CiftiAverageRoiCorrelationCiftiRoiParamsDict {
    "@type"?: "cifti-roi";
    "roi-cifti": InputPathType;
    "in-memory": boolean;
}
type CiftiAverageRoiCorrelationCiftiRoiParamsDictTagged = Required<Pick<CiftiAverageRoiCorrelationCiftiRoiParamsDict, '@type'>> & CiftiAverageRoiCorrelationCiftiRoiParamsDict;


interface CiftiAverageRoiCorrelationCiftiParamsDict {
    "@type"?: "cifti";
    "cifti-in": InputPathType;
}
type CiftiAverageRoiCorrelationCiftiParamsDictTagged = Required<Pick<CiftiAverageRoiCorrelationCiftiParamsDict, '@type'>> & CiftiAverageRoiCorrelationCiftiParamsDict;


interface CiftiAverageRoiCorrelationParamsDict {
    "@type"?: "workbench/cifti-average-roi-correlation";
    "cifti-out": string;
    "cifti-roi"?: CiftiAverageRoiCorrelationCiftiRoiParamsDict | null | undefined;
    "roi-metric"?: InputPathType | null | undefined;
    "roi-metric"?: InputPathType | null | undefined;
    "roi-metric"?: InputPathType | null | undefined;
    "roi-vol"?: InputPathType | null | undefined;
    "left-surf"?: InputPathType | null | undefined;
    "right-surf"?: InputPathType | null | undefined;
    "cerebellum-surf"?: InputPathType | null | undefined;
    "cifti"?: Array<CiftiAverageRoiCorrelationCiftiParamsDict> | null | undefined;
}
type CiftiAverageRoiCorrelationParamsDictTagged = Required<Pick<CiftiAverageRoiCorrelationParamsDict, '@type'>> & CiftiAverageRoiCorrelationParamsDict;


/**
 * Build parameters.
 *
 * @param roi_cifti the roi cifti file
 * @param in_memory cache the roi in memory so that it isn't re-read for each input cifti
 *
 * @returns Parameter dictionary
 */
function cifti_average_roi_correlation_cifti_roi(
    roi_cifti: InputPathType,
    in_memory: boolean = false,
): CiftiAverageRoiCorrelationCiftiRoiParamsDictTagged {
    const params = {
        "@type": "cifti-roi" as const,
        "roi-cifti": roi_cifti,
        "in-memory": in_memory,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_average_roi_correlation_cifti_roi_cargs(
    params: CiftiAverageRoiCorrelationCiftiRoiParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "-cifti-roi",
        execution.inputFile((params["roi-cifti"] ?? null)),
        (((params["in-memory"] ?? false)) ? "-in-memory" : "")
    );
    return cargs;
}


/**
 * Build parameters.
 *
 * @param cifti_in a cifti file to average across
 *
 * @returns Parameter dictionary
 */
function cifti_average_roi_correlation_cifti(
    cifti_in: InputPathType,
): CiftiAverageRoiCorrelationCiftiParamsDictTagged {
    const params = {
        "@type": "cifti" as const,
        "cifti-in": cifti_in,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_average_roi_correlation_cifti_cargs(
    params: CiftiAverageRoiCorrelationCiftiParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "-cifti",
        execution.inputFile((params["cifti-in"] ?? null))
    );
    return cargs;
}


/**
 * Output object returned when calling `CiftiAverageRoiCorrelationParamsDict(...)`.
 *
 * @interface
 */
interface CiftiAverageRoiCorrelationOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * output cifti file
     */
    cifti_out: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param cifti_out output cifti file
 * @param cifti_roi cifti file containing combined weights
 * @param roi_metric weights to use for left hempsphere

the left roi as a metric file
 * @param roi_metric_ weights to use for right hempsphere

the right roi as a metric file
 * @param roi_metric_2 weights to use for cerebellum surface

the cerebellum roi as a metric file
 * @param roi_vol voxel weights to use

the roi volume file
 * @param left_surf specify the left surface for vertex area correction

the left surface file
 * @param right_surf specify the right surface for vertex area correction

the right surface file
 * @param cerebellum_surf specify the cerebellum surface for vertex area correction

the cerebellum surface file
 * @param cifti specify an input cifti file
 *
 * @returns Parameter dictionary
 */
function cifti_average_roi_correlation_params(
    cifti_out: string,
    cifti_roi: CiftiAverageRoiCorrelationCiftiRoiParamsDict | null = null,
    roi_metric: InputPathType | null = null,
    roi_metric_: InputPathType | null = null,
    roi_metric_2: InputPathType | null = null,
    roi_vol: InputPathType | null = null,
    left_surf: InputPathType | null = null,
    right_surf: InputPathType | null = null,
    cerebellum_surf: InputPathType | null = null,
    cifti: Array<CiftiAverageRoiCorrelationCiftiParamsDict> | null = null,
): CiftiAverageRoiCorrelationParamsDictTagged {
    const params = {
        "@type": "workbench/cifti-average-roi-correlation" as const,
        "cifti-out": cifti_out,
    };
    if (cifti_roi !== null) {
        params["cifti-roi"] = cifti_roi;
    }
    if (roi_metric !== null) {
        params["roi-metric"] = roi_metric;
    }
    if (roi_metric_ !== null) {
        params["roi-metric"] = roi_metric_;
    }
    if (roi_metric_2 !== null) {
        params["roi-metric"] = roi_metric_2;
    }
    if (roi_vol !== null) {
        params["roi-vol"] = roi_vol;
    }
    if (left_surf !== null) {
        params["left-surf"] = left_surf;
    }
    if (right_surf !== null) {
        params["right-surf"] = right_surf;
    }
    if (cerebellum_surf !== null) {
        params["cerebellum-surf"] = cerebellum_surf;
    }
    if (cifti !== null) {
        params["cifti"] = cifti;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_average_roi_correlation_cargs(
    params: CiftiAverageRoiCorrelationParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "wb_command",
        "-cifti-average-roi-correlation"
    );
    cargs.push(
        (params["cifti-out"] ?? null),
        ...(((params["cifti-roi"] ?? null) !== null) ? cifti_average_roi_correlation_cifti_roi_cargs((params["cifti-roi"] ?? null), execution) : []),
        "-left-roi",
        (((params["roi-metric"] ?? null) !== null) ? execution.inputFile((params["roi-metric"] ?? null)) : ""),
        "-right-roi",
        (((params["roi-metric"] ?? null) !== null) ? execution.inputFile((params["roi-metric"] ?? null)) : ""),
        "-cerebellum-roi",
        (((params["roi-metric"] ?? null) !== null) ? execution.inputFile((params["roi-metric"] ?? null)) : ""),
        "-vol-roi",
        (((params["roi-vol"] ?? null) !== null) ? execution.inputFile((params["roi-vol"] ?? null)) : ""),
        "-left-area-surf",
        (((params["left-surf"] ?? null) !== null) ? execution.inputFile((params["left-surf"] ?? null)) : ""),
        "-right-area-surf",
        (((params["right-surf"] ?? null) !== null) ? execution.inputFile((params["right-surf"] ?? null)) : ""),
        "-cerebellum-area-surf",
        (((params["cerebellum-surf"] ?? null) !== null) ? execution.inputFile((params["cerebellum-surf"] ?? null)) : ""),
        ...(((params["cifti"] ?? null) !== null) ? (params["cifti"] ?? null).map(s => cifti_average_roi_correlation_cifti_cargs(s, execution)).flat() : [])
    );
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function cifti_average_roi_correlation_outputs(
    params: CiftiAverageRoiCorrelationParamsDict,
    execution: Execution,
): CiftiAverageRoiCorrelationOutputs {
    const ret: CiftiAverageRoiCorrelationOutputs = {
        root: execution.outputFile("."),
        cifti_out: execution.outputFile([(params["cifti-out"] ?? null)].join('')),
    };
    return ret;
}


/**
 * CORRELATE ROI AVERAGE WITH ALL ROWS THEN AVERAGE ACROSS SUBJECTS.
 *
 * Averages rows for each map of the ROI(s), takes the correlation of each ROI average to the rest of the rows in the same file, applies the fisher small z transform, then averages the results across all files.  ROIs are always treated as weighting functions, including negative values.  For efficiency, ensure that everything that is not intended to be used is zero in the ROI map.  If -cifti-roi is specified, -left-roi, -right-roi, -cerebellum-roi, and -vol-roi must not be specified.  If multiple non-cifti ROI files are specified, they must have the same number of columns.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CiftiAverageRoiCorrelationOutputs`).
 */
function cifti_average_roi_correlation_execute(
    params: CiftiAverageRoiCorrelationParamsDict,
    runner: Runner | null = null,
): CiftiAverageRoiCorrelationOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(CIFTI_AVERAGE_ROI_CORRELATION_METADATA);
    params = execution.params(params)
    const cargs = cifti_average_roi_correlation_cargs(params, execution)
    const ret = cifti_average_roi_correlation_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * CORRELATE ROI AVERAGE WITH ALL ROWS THEN AVERAGE ACROSS SUBJECTS.
 *
 * Averages rows for each map of the ROI(s), takes the correlation of each ROI average to the rest of the rows in the same file, applies the fisher small z transform, then averages the results across all files.  ROIs are always treated as weighting functions, including negative values.  For efficiency, ensure that everything that is not intended to be used is zero in the ROI map.  If -cifti-roi is specified, -left-roi, -right-roi, -cerebellum-roi, and -vol-roi must not be specified.  If multiple non-cifti ROI files are specified, they must have the same number of columns.
 *
 * @param cifti_out output cifti file
 * @param cifti_roi cifti file containing combined weights
 * @param roi_metric weights to use for left hempsphere

the left roi as a metric file
 * @param roi_metric_ weights to use for right hempsphere

the right roi as a metric file
 * @param roi_metric_2 weights to use for cerebellum surface

the cerebellum roi as a metric file
 * @param roi_vol voxel weights to use

the roi volume file
 * @param left_surf specify the left surface for vertex area correction

the left surface file
 * @param right_surf specify the right surface for vertex area correction

the right surface file
 * @param cerebellum_surf specify the cerebellum surface for vertex area correction

the cerebellum surface file
 * @param cifti specify an input cifti file
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CiftiAverageRoiCorrelationOutputs`).
 */
function cifti_average_roi_correlation(
    cifti_out: string,
    cifti_roi: CiftiAverageRoiCorrelationCiftiRoiParamsDict | null = null,
    roi_metric: InputPathType | null = null,
    roi_metric_: InputPathType | null = null,
    roi_metric_2: InputPathType | null = null,
    roi_vol: InputPathType | null = null,
    left_surf: InputPathType | null = null,
    right_surf: InputPathType | null = null,
    cerebellum_surf: InputPathType | null = null,
    cifti: Array<CiftiAverageRoiCorrelationCiftiParamsDict> | null = null,
    runner: Runner | null = null,
): CiftiAverageRoiCorrelationOutputs {
    const params = cifti_average_roi_correlation_params(cifti_out, cifti_roi, roi_metric, roi_metric_, roi_metric_2, roi_vol, left_surf, right_surf, cerebellum_surf, cifti)
    return cifti_average_roi_correlation_execute(params, runner);
}


export {
      CIFTI_AVERAGE_ROI_CORRELATION_METADATA,
      CiftiAverageRoiCorrelationCiftiParamsDict,
      CiftiAverageRoiCorrelationCiftiParamsDictTagged,
      CiftiAverageRoiCorrelationCiftiRoiParamsDict,
      CiftiAverageRoiCorrelationCiftiRoiParamsDictTagged,
      CiftiAverageRoiCorrelationOutputs,
      CiftiAverageRoiCorrelationParamsDict,
      CiftiAverageRoiCorrelationParamsDictTagged,
      cifti_average_roi_correlation,
      cifti_average_roi_correlation_cifti,
      cifti_average_roi_correlation_cifti_roi,
      cifti_average_roi_correlation_execute,
      cifti_average_roi_correlation_params,
};
