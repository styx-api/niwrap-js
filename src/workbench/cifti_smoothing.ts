// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const CIFTI_SMOOTHING_METADATA: Metadata = {
    id: "13acc3e6ded7de43dd47b9ee49249c55bebbc762.workbench",
    name: "cifti-smoothing",
    package: "workbench",
    container_image_tag: "nx10x/workbench:2.1.0",
};


interface CiftiSmoothingLeftSurfaceParamsDict {
    "@type"?: "left-surface";
    "surface": InputPathType;
    "area-metric"?: InputPathType | null | undefined;
}
type CiftiSmoothingLeftSurfaceParamsDictTagged = Required<Pick<CiftiSmoothingLeftSurfaceParamsDict, '@type'>> & CiftiSmoothingLeftSurfaceParamsDict;


interface CiftiSmoothingRightSurfaceParamsDict {
    "@type"?: "right-surface";
    "surface": InputPathType;
    "area-metric"?: InputPathType | null | undefined;
}
type CiftiSmoothingRightSurfaceParamsDictTagged = Required<Pick<CiftiSmoothingRightSurfaceParamsDict, '@type'>> & CiftiSmoothingRightSurfaceParamsDict;


interface CiftiSmoothingCerebellumSurfaceParamsDict {
    "@type"?: "cerebellum-surface";
    "surface": InputPathType;
    "area-metric"?: InputPathType | null | undefined;
}
type CiftiSmoothingCerebellumSurfaceParamsDictTagged = Required<Pick<CiftiSmoothingCerebellumSurfaceParamsDict, '@type'>> & CiftiSmoothingCerebellumSurfaceParamsDict;


interface CiftiSmoothingSurfaceParamsDict {
    "@type"?: "surface";
    "structure": string;
    "surface": InputPathType;
    "area-metric"?: InputPathType | null | undefined;
}
type CiftiSmoothingSurfaceParamsDictTagged = Required<Pick<CiftiSmoothingSurfaceParamsDict, '@type'>> & CiftiSmoothingSurfaceParamsDict;


interface CiftiSmoothingParamsDict {
    "@type"?: "workbench/cifti-smoothing";
    "cifti-out": string;
    "fwhm": boolean;
    "left-surface"?: CiftiSmoothingLeftSurfaceParamsDict | null | undefined;
    "right-surface"?: CiftiSmoothingRightSurfaceParamsDict | null | undefined;
    "cerebellum-surface"?: CiftiSmoothingCerebellumSurfaceParamsDict | null | undefined;
    "roi-cifti"?: InputPathType | null | undefined;
    "fix-zeros-volume": boolean;
    "fix-zeros-surface": boolean;
    "merged-volume": boolean;
    "surface"?: Array<CiftiSmoothingSurfaceParamsDict> | null | undefined;
    "cifti": InputPathType;
    "surface-kernel": number;
    "volume-kernel": number;
    "direction": string;
}
type CiftiSmoothingParamsDictTagged = Required<Pick<CiftiSmoothingParamsDict, '@type'>> & CiftiSmoothingParamsDict;


/**
 * Build parameters.
 *
 * @param surface the left surface file
 * @param area_metric vertex areas to use instead of computing them from the left surface

the corrected vertex areas, as a metric
 *
 * @returns Parameter dictionary
 */
function cifti_smoothing_left_surface(
    surface: InputPathType,
    area_metric: InputPathType | null = null,
): CiftiSmoothingLeftSurfaceParamsDictTagged {
    const params = {
        "@type": "left-surface" as const,
        "surface": surface,
    };
    if (area_metric !== null) {
        params["area-metric"] = area_metric;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_smoothing_left_surface_cargs(
    params: CiftiSmoothingLeftSurfaceParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["area-metric"] ?? null) !== null) {
        cargs.push(
            "-left-surface",
            execution.inputFile((params["surface"] ?? null)),
            ["-left-corrected-areas", execution.inputFile((params["area-metric"] ?? null))].join('')
        );
    }
    return cargs;
}


/**
 * Build parameters.
 *
 * @param surface the right surface file
 * @param area_metric vertex areas to use instead of computing them from the right surface

the corrected vertex areas, as a metric
 *
 * @returns Parameter dictionary
 */
function cifti_smoothing_right_surface(
    surface: InputPathType,
    area_metric: InputPathType | null = null,
): CiftiSmoothingRightSurfaceParamsDictTagged {
    const params = {
        "@type": "right-surface" as const,
        "surface": surface,
    };
    if (area_metric !== null) {
        params["area-metric"] = area_metric;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_smoothing_right_surface_cargs(
    params: CiftiSmoothingRightSurfaceParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["area-metric"] ?? null) !== null) {
        cargs.push(
            "-right-surface",
            execution.inputFile((params["surface"] ?? null)),
            ["-right-corrected-areas", execution.inputFile((params["area-metric"] ?? null))].join('')
        );
    }
    return cargs;
}


/**
 * Build parameters.
 *
 * @param surface the cerebellum surface file
 * @param area_metric vertex areas to use instead of computing them from the cerebellum surface

the corrected vertex areas, as a metric
 *
 * @returns Parameter dictionary
 */
function cifti_smoothing_cerebellum_surface(
    surface: InputPathType,
    area_metric: InputPathType | null = null,
): CiftiSmoothingCerebellumSurfaceParamsDictTagged {
    const params = {
        "@type": "cerebellum-surface" as const,
        "surface": surface,
    };
    if (area_metric !== null) {
        params["area-metric"] = area_metric;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_smoothing_cerebellum_surface_cargs(
    params: CiftiSmoothingCerebellumSurfaceParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["area-metric"] ?? null) !== null) {
        cargs.push(
            "-cerebellum-surface",
            execution.inputFile((params["surface"] ?? null)),
            ["-cerebellum-corrected-areas", execution.inputFile((params["area-metric"] ?? null))].join('')
        );
    }
    return cargs;
}


/**
 * Build parameters.
 *
 * @param structure the surface structure name
 * @param surface the surface file
 * @param area_metric vertex areas to use instead of computing them from the surface

the corrected vertex areas, as a metric
 *
 * @returns Parameter dictionary
 */
function cifti_smoothing_surface(
    structure: string,
    surface: InputPathType,
    area_metric: InputPathType | null = null,
): CiftiSmoothingSurfaceParamsDictTagged {
    const params = {
        "@type": "surface" as const,
        "structure": structure,
        "surface": surface,
    };
    if (area_metric !== null) {
        params["area-metric"] = area_metric;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_smoothing_surface_cargs(
    params: CiftiSmoothingSurfaceParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["area-metric"] ?? null) !== null) {
        cargs.push(
            "-surface",
            (params["structure"] ?? null),
            execution.inputFile((params["surface"] ?? null)),
            ["-corrected-areas", execution.inputFile((params["area-metric"] ?? null))].join('')
        );
    }
    return cargs;
}


/**
 * Output object returned when calling `CiftiSmoothingParamsDict(...)`.
 *
 * @interface
 */
interface CiftiSmoothingOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * the output cifti
     */
    cifti_out: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param cifti_out the output cifti
 * @param cifti the input cifti
 * @param surface_kernel the size of the gaussian surface smoothing kernel in mm, as sigma by default
 * @param volume_kernel the size of the gaussian volume smoothing kernel in mm, as sigma by default
 * @param direction which dimension to smooth along, ROW or COLUMN
 * @param fwhm kernel sizes are FWHM, not sigma
 * @param left_surface specify the left cortical surface to use
 * @param right_surface specify the right cortical surface to use
 * @param cerebellum_surface specify the cerebellum surface to use
 * @param roi_cifti smooth only within regions of interest

the regions to smooth within, as a cifti file
 * @param fix_zeros_volume treat values of zero in the volume as missing data
 * @param fix_zeros_surface treat values of zero on the surface as missing data
 * @param merged_volume smooth across subcortical structure boundaries
 * @param surface specify a surface by structure name
 *
 * @returns Parameter dictionary
 */
function cifti_smoothing_params(
    cifti_out: string,
    cifti: InputPathType,
    surface_kernel: number,
    volume_kernel: number,
    direction: string,
    fwhm: boolean = false,
    left_surface: CiftiSmoothingLeftSurfaceParamsDict | null = null,
    right_surface: CiftiSmoothingRightSurfaceParamsDict | null = null,
    cerebellum_surface: CiftiSmoothingCerebellumSurfaceParamsDict | null = null,
    roi_cifti: InputPathType | null = null,
    fix_zeros_volume: boolean = false,
    fix_zeros_surface: boolean = false,
    merged_volume: boolean = false,
    surface: Array<CiftiSmoothingSurfaceParamsDict> | null = null,
): CiftiSmoothingParamsDictTagged {
    const params = {
        "@type": "workbench/cifti-smoothing" as const,
        "cifti-out": cifti_out,
        "fwhm": fwhm,
        "fix-zeros-volume": fix_zeros_volume,
        "fix-zeros-surface": fix_zeros_surface,
        "merged-volume": merged_volume,
        "cifti": cifti,
        "surface-kernel": surface_kernel,
        "volume-kernel": volume_kernel,
        "direction": direction,
    };
    if (left_surface !== null) {
        params["left-surface"] = left_surface;
    }
    if (right_surface !== null) {
        params["right-surface"] = right_surface;
    }
    if (cerebellum_surface !== null) {
        params["cerebellum-surface"] = cerebellum_surface;
    }
    if (roi_cifti !== null) {
        params["roi-cifti"] = roi_cifti;
    }
    if (surface !== null) {
        params["surface"] = surface;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function cifti_smoothing_cargs(
    params: CiftiSmoothingParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["fwhm"] ?? false) || (params["left-surface"] ?? null) !== null || (params["right-surface"] ?? null) !== null || (params["cerebellum-surface"] ?? null) !== null || (params["roi-cifti"] ?? null) !== null || (params["fix-zeros-volume"] ?? false) || (params["fix-zeros-surface"] ?? false) || (params["merged-volume"] ?? false) || (params["surface"] ?? null) !== null) {
        cargs.push(
            "wb_command",
            "-cifti-smoothing",
            (params["cifti-out"] ?? null),
            (((params["fwhm"] ?? false)) ? "-fwhm" : ""),
            ...(((params["left-surface"] ?? null) !== null) ? cifti_smoothing_left_surface_cargs((params["left-surface"] ?? null), execution) : []),
            ...(((params["right-surface"] ?? null) !== null) ? cifti_smoothing_right_surface_cargs((params["right-surface"] ?? null), execution) : []),
            ...(((params["cerebellum-surface"] ?? null) !== null) ? cifti_smoothing_cerebellum_surface_cargs((params["cerebellum-surface"] ?? null), execution) : []),
            ["-cifti-roi", (((params["roi-cifti"] ?? null) !== null) ? execution.inputFile((params["roi-cifti"] ?? null)) : "")].join(''),
            (((params["fix-zeros-volume"] ?? false)) ? "-fix-zeros-volume" : ""),
            (((params["fix-zeros-surface"] ?? false)) ? "-fix-zeros-surface" : ""),
            (((params["merged-volume"] ?? false)) ? "-merged-volume" : ""),
            ...(((params["surface"] ?? null) !== null) ? (params["surface"] ?? null).map(s => cifti_smoothing_surface_cargs(s, execution)).flat() : [])
        );
    }
    cargs.push(execution.inputFile((params["cifti"] ?? null)));
    cargs.push(String((params["surface-kernel"] ?? null)));
    cargs.push(String((params["volume-kernel"] ?? null)));
    cargs.push((params["direction"] ?? null));
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function cifti_smoothing_outputs(
    params: CiftiSmoothingParamsDict,
    execution: Execution,
): CiftiSmoothingOutputs {
    const ret: CiftiSmoothingOutputs = {
        root: execution.outputFile("."),
        cifti_out: execution.outputFile([(params["cifti-out"] ?? null)].join('')),
    };
    return ret;
}


/**
 * SMOOTH A CIFTI FILE.
 *
 * The input cifti file must have a brain models mapping on the chosen dimension, columns for .dtseries, and either for .dconn.  By default, data in different structures is smoothed independently (i.e., "parcel constrained" smoothing), so volume structures that touch do not smooth across this boundary.  Specify -merged-volume to ignore these boundaries.  Surface smoothing uses the GEO_GAUSS_AREA smoothing method.
 *
 * The -*-corrected-areas options are intended for when it is unavoidable to smooth on group average surfaces, it is only an approximate correction for the reduction of structure in a group average surface.  It is better to smooth the data on individuals before averaging, when feasible.
 *
 * The -fix-zeros-* options will treat values of zero as lack of data, and not use that value when generating the smoothed values, but will fill zeros with extrapolated values.  The ROI should have a brain models mapping along columns, exactly matching the mapping of the chosen direction in the input file.  Data outside the ROI is ignored.
 *
 * The <structure> argument of -surface must be one of the following strings:
 *
 * CORTEX_LEFT
 * CORTEX_RIGHT
 * CEREBELLUM
 * ACCUMBENS_LEFT
 * ACCUMBENS_RIGHT
 * ALL_GREY_MATTER
 * ALL_WHITE_MATTER
 * AMYGDALA_LEFT
 * AMYGDALA_RIGHT
 * BRAIN_STEM
 * CAUDATE_LEFT
 * CAUDATE_RIGHT
 * CEREBELLAR_WHITE_MATTER_LEFT
 * CEREBELLAR_WHITE_MATTER_RIGHT
 * CEREBELLUM_LEFT
 * CEREBELLUM_RIGHT
 * CEREBRAL_WHITE_MATTER_LEFT
 * CEREBRAL_WHITE_MATTER_RIGHT
 * CORTEX
 * DIENCEPHALON_VENTRAL_LEFT
 * DIENCEPHALON_VENTRAL_RIGHT
 * HIPPOCAMPUS_LEFT
 * HIPPOCAMPUS_RIGHT
 * HIPPOCAMPUS_DENTATE_LEFT
 * HIPPOCAMPUS_DENTATE_RIGHT
 * INVALID
 * OTHER
 * OTHER_GREY_MATTER
 * OTHER_WHITE_MATTER
 * PALLIDUM_LEFT
 * PALLIDUM_RIGHT
 * PUTAMEN_LEFT
 * PUTAMEN_RIGHT
 * THALAMUS_LEFT
 * THALAMUS_RIGHT.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CiftiSmoothingOutputs`).
 */
function cifti_smoothing_execute(
    params: CiftiSmoothingParamsDict,
    runner: Runner | null = null,
): CiftiSmoothingOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(CIFTI_SMOOTHING_METADATA);
    params = execution.params(params)
    const cargs = cifti_smoothing_cargs(params, execution)
    const ret = cifti_smoothing_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * SMOOTH A CIFTI FILE.
 *
 * The input cifti file must have a brain models mapping on the chosen dimension, columns for .dtseries, and either for .dconn.  By default, data in different structures is smoothed independently (i.e., "parcel constrained" smoothing), so volume structures that touch do not smooth across this boundary.  Specify -merged-volume to ignore these boundaries.  Surface smoothing uses the GEO_GAUSS_AREA smoothing method.
 *
 * The -*-corrected-areas options are intended for when it is unavoidable to smooth on group average surfaces, it is only an approximate correction for the reduction of structure in a group average surface.  It is better to smooth the data on individuals before averaging, when feasible.
 *
 * The -fix-zeros-* options will treat values of zero as lack of data, and not use that value when generating the smoothed values, but will fill zeros with extrapolated values.  The ROI should have a brain models mapping along columns, exactly matching the mapping of the chosen direction in the input file.  Data outside the ROI is ignored.
 *
 * The <structure> argument of -surface must be one of the following strings:
 *
 * CORTEX_LEFT
 * CORTEX_RIGHT
 * CEREBELLUM
 * ACCUMBENS_LEFT
 * ACCUMBENS_RIGHT
 * ALL_GREY_MATTER
 * ALL_WHITE_MATTER
 * AMYGDALA_LEFT
 * AMYGDALA_RIGHT
 * BRAIN_STEM
 * CAUDATE_LEFT
 * CAUDATE_RIGHT
 * CEREBELLAR_WHITE_MATTER_LEFT
 * CEREBELLAR_WHITE_MATTER_RIGHT
 * CEREBELLUM_LEFT
 * CEREBELLUM_RIGHT
 * CEREBRAL_WHITE_MATTER_LEFT
 * CEREBRAL_WHITE_MATTER_RIGHT
 * CORTEX
 * DIENCEPHALON_VENTRAL_LEFT
 * DIENCEPHALON_VENTRAL_RIGHT
 * HIPPOCAMPUS_LEFT
 * HIPPOCAMPUS_RIGHT
 * HIPPOCAMPUS_DENTATE_LEFT
 * HIPPOCAMPUS_DENTATE_RIGHT
 * INVALID
 * OTHER
 * OTHER_GREY_MATTER
 * OTHER_WHITE_MATTER
 * PALLIDUM_LEFT
 * PALLIDUM_RIGHT
 * PUTAMEN_LEFT
 * PUTAMEN_RIGHT
 * THALAMUS_LEFT
 * THALAMUS_RIGHT.
 *
 * @param cifti_out the output cifti
 * @param cifti the input cifti
 * @param surface_kernel the size of the gaussian surface smoothing kernel in mm, as sigma by default
 * @param volume_kernel the size of the gaussian volume smoothing kernel in mm, as sigma by default
 * @param direction which dimension to smooth along, ROW or COLUMN
 * @param fwhm kernel sizes are FWHM, not sigma
 * @param left_surface specify the left cortical surface to use
 * @param right_surface specify the right cortical surface to use
 * @param cerebellum_surface specify the cerebellum surface to use
 * @param roi_cifti smooth only within regions of interest

the regions to smooth within, as a cifti file
 * @param fix_zeros_volume treat values of zero in the volume as missing data
 * @param fix_zeros_surface treat values of zero on the surface as missing data
 * @param merged_volume smooth across subcortical structure boundaries
 * @param surface specify a surface by structure name
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CiftiSmoothingOutputs`).
 */
function cifti_smoothing(
    cifti_out: string,
    cifti: InputPathType,
    surface_kernel: number,
    volume_kernel: number,
    direction: string,
    fwhm: boolean = false,
    left_surface: CiftiSmoothingLeftSurfaceParamsDict | null = null,
    right_surface: CiftiSmoothingRightSurfaceParamsDict | null = null,
    cerebellum_surface: CiftiSmoothingCerebellumSurfaceParamsDict | null = null,
    roi_cifti: InputPathType | null = null,
    fix_zeros_volume: boolean = false,
    fix_zeros_surface: boolean = false,
    merged_volume: boolean = false,
    surface: Array<CiftiSmoothingSurfaceParamsDict> | null = null,
    runner: Runner | null = null,
): CiftiSmoothingOutputs {
    const params = cifti_smoothing_params(cifti_out, cifti, surface_kernel, volume_kernel, direction, fwhm, left_surface, right_surface, cerebellum_surface, roi_cifti, fix_zeros_volume, fix_zeros_surface, merged_volume, surface)
    return cifti_smoothing_execute(params, runner);
}


export {
      CIFTI_SMOOTHING_METADATA,
      CiftiSmoothingCerebellumSurfaceParamsDict,
      CiftiSmoothingCerebellumSurfaceParamsDictTagged,
      CiftiSmoothingLeftSurfaceParamsDict,
      CiftiSmoothingLeftSurfaceParamsDictTagged,
      CiftiSmoothingOutputs,
      CiftiSmoothingParamsDict,
      CiftiSmoothingParamsDictTagged,
      CiftiSmoothingRightSurfaceParamsDict,
      CiftiSmoothingRightSurfaceParamsDictTagged,
      CiftiSmoothingSurfaceParamsDict,
      CiftiSmoothingSurfaceParamsDictTagged,
      cifti_smoothing,
      cifti_smoothing_cerebellum_surface,
      cifti_smoothing_execute,
      cifti_smoothing_left_surface,
      cifti_smoothing_params,
      cifti_smoothing_right_surface,
      cifti_smoothing_surface,
};
