// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const SURF_EXTREMA_METADATA: Metadata = {
    id: "84b854a87242a5d67c86897020fb70cd6c8e1945.boutiques",
    name: "SurfExtrema",
    package: "afni",
    container_image_tag: "afni/afni_make_build:AFNI_24.2.06",
};


interface SurfExtremaParameters {
    "__STYXTYPE__": "SurfExtrema";
    "input"?: InputPathType | null | undefined;
    "hood"?: number | null | undefined;
    "thresh"?: number | null | undefined;
    "gthresh"?: number | null | undefined;
    "gscale"?: "NONE" | "LMEAN" | "GMEAN" | null | undefined;
    "extype"?: "MAX" | "MIN" | "ABS" | null | undefined;
    "prefix": string;
    "table"?: string | null | undefined;
}


function dynCargs(
    t: string,
): Function | undefined {
    /**
     * Get build cargs function by command type.
    
     * @param t Command type
    
     * @returns Build cargs function.
     */
    const cargsFuncs = {
        "SurfExtrema": surf_extrema_cargs,
    };
    return cargsFuncs[t];
}


function dynOutputs(
    t: string,
): Function | undefined {
    /**
     * Get build outputs function by command type.
    
     * @param t Command type
    
     * @returns Build outputs function.
     */
    const outputsFuncs = {
        "SurfExtrema": surf_extrema_outputs,
    };
    return outputsFuncs[t];
}


/**
 * Output object returned when calling `surf_extrema(...)`.
 *
 * @interface
 */
interface SurfExtremaOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * Output file containing the scaled average gradient values.
     */
    output_grd: OutputPathType;
    /**
     * Output file containing the nodes with maximum values.
     */
    output_ext: OutputPathType;
}


function surf_extrema_params(
    prefix: string,
    input: InputPathType | null = null,
    hood: number | null = null,
    thresh: number | null = null,
    gthresh: number | null = null,
    gscale: "NONE" | "LMEAN" | "GMEAN" | null = null,
    extype: "MAX" | "MIN" | "ABS" | null = null,
    table: string | null = null,
): SurfExtremaParameters {
    /**
     * Build parameters.
    
     * @param prefix Prefix for the output datasets.
     * @param input Input dataset in which Extrema are to be identified.
     * @param hood Neighborhood radius (R) in mm. Default is 8 mm.
     * @param thresh Do not consider nodes with value less than this threshold. Default is 0.
     * @param gthresh Do not consider nodes with gradient less than this threshold. Default is 0.01.
     * @param gscale Scaling to apply to gradient computation.
     * @param extype Find maxima, minima, or extrema. Options are MAX (default), MIN, ABS.
     * @param table Name of file in which to store a record of the extrema found.
    
     * @returns Parameter dictionary
     */
    const params = {
        "__STYXTYPE__": "SurfExtrema" as const,
        "prefix": prefix,
    };
    if (input !== null) {
        params["input"] = input;
    }
    if (hood !== null) {
        params["hood"] = hood;
    }
    if (thresh !== null) {
        params["thresh"] = thresh;
    }
    if (gthresh !== null) {
        params["gthresh"] = gthresh;
    }
    if (gscale !== null) {
        params["gscale"] = gscale;
    }
    if (extype !== null) {
        params["extype"] = extype;
    }
    if (table !== null) {
        params["table"] = table;
    }
    return params;
}


function surf_extrema_cargs(
    params: SurfExtremaParameters,
    execution: Execution,
): string[] {
    /**
     * Build command-line arguments from parameters.
    
     * @param params The parameters.
     * @param execution The execution object for resolving input paths.
    
     * @returns Command-line arguments.
     */
    const cargs: string[] = [];
    cargs.push("SurfExtrema");
    if ((params["input"] ?? null) !== null) {
        cargs.push(
            "-input",
            execution.inputFile((params["input"] ?? null))
        );
    }
    if ((params["hood"] ?? null) !== null) {
        cargs.push(
            "-nbhd_rad",
            String((params["hood"] ?? null))
        );
    }
    if ((params["thresh"] ?? null) !== null) {
        cargs.push(
            "-thresh",
            String((params["thresh"] ?? null))
        );
    }
    if ((params["gthresh"] ?? null) !== null) {
        cargs.push(
            "-gthresh",
            String((params["gthresh"] ?? null))
        );
    }
    if ((params["gscale"] ?? null) !== null) {
        cargs.push(
            "-gscale",
            (params["gscale"] ?? null)
        );
    }
    if ((params["extype"] ?? null) !== null) {
        cargs.push(
            "-extype",
            (params["extype"] ?? null)
        );
    }
    cargs.push(
        "-prefix",
        (params["prefix"] ?? null)
    );
    if ((params["table"] ?? null) !== null) {
        cargs.push(
            "-table",
            (params["table"] ?? null)
        );
    }
    return cargs;
}


function surf_extrema_outputs(
    params: SurfExtremaParameters,
    execution: Execution,
): SurfExtremaOutputs {
    /**
     * Build outputs object containing output file paths and possibly stdout/stderr.
    
     * @param params The parameters.
     * @param execution The execution object for resolving input paths.
    
     * @returns Outputs object.
     */
    const ret: SurfExtremaOutputs = {
        root: execution.outputFile("."),
        output_grd: execution.outputFile([(params["prefix"] ?? null), ".grd"].join('')),
        output_ext: execution.outputFile([(params["prefix"] ?? null), ".ext"].join('')),
    };
    return ret;
}


function surf_extrema_execute(
    params: SurfExtremaParameters,
    execution: Execution,
): SurfExtremaOutputs {
    /**
     * A program finding the local extrema in a dataset.
     * 
     * Author: AFNI Developers
     * 
     * URL: https://afni.nimh.nih.gov/
    
     * @param params The parameters.
     * @param execution The execution object.
    
     * @returns NamedTuple of outputs (described in `SurfExtremaOutputs`).
     */
    params = execution.params(params)
    const cargs = surf_extrema_cargs(params, execution)
    const ret = surf_extrema_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


function surf_extrema(
    prefix: string,
    input: InputPathType | null = null,
    hood: number | null = null,
    thresh: number | null = null,
    gthresh: number | null = null,
    gscale: "NONE" | "LMEAN" | "GMEAN" | null = null,
    extype: "MAX" | "MIN" | "ABS" | null = null,
    table: string | null = null,
    runner: Runner | null = null,
): SurfExtremaOutputs {
    /**
     * A program finding the local extrema in a dataset.
     * 
     * Author: AFNI Developers
     * 
     * URL: https://afni.nimh.nih.gov/
    
     * @param prefix Prefix for the output datasets.
     * @param input Input dataset in which Extrema are to be identified.
     * @param hood Neighborhood radius (R) in mm. Default is 8 mm.
     * @param thresh Do not consider nodes with value less than this threshold. Default is 0.
     * @param gthresh Do not consider nodes with gradient less than this threshold. Default is 0.01.
     * @param gscale Scaling to apply to gradient computation.
     * @param extype Find maxima, minima, or extrema. Options are MAX (default), MIN, ABS.
     * @param table Name of file in which to store a record of the extrema found.
     * @param runner Command runner
    
     * @returns NamedTuple of outputs (described in `SurfExtremaOutputs`).
     */
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(SURF_EXTREMA_METADATA);
    const params = surf_extrema_params(prefix, input, hood, thresh, gthresh, gscale, extype, table)
    return surf_extrema_execute(params, execution);
}


export {
      SURF_EXTREMA_METADATA,
      SurfExtremaOutputs,
      SurfExtremaParameters,
      surf_extrema,
      surf_extrema_params,
};
