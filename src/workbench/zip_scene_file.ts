// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const ZIP_SCENE_FILE_METADATA: Metadata = {
    id: "b259c5172b5ae3668ffcdba00a5b5a9f3c90cbb1.workbench",
    name: "zip-scene-file",
    package: "workbench",
};


interface ZipSceneFileParameters {
    "@type"?: "workbench/zip-scene-file";
    "directory"?: string | null | undefined;
    "skip-missing": boolean;
    "write-scene-file": boolean;
    "scene-file": string;
    "extract-folder": string;
    "zip-file": string;
}
type ZipSceneFileParametersTagged = Required<Pick<ZipSceneFileParameters, '@type'>> & ZipSceneFileParameters;


/**
 * Output object returned when calling `ZipSceneFileParameters(...)`.
 *
 * @interface
 */
interface ZipSceneFileOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param directory specify a directory that all data files are somewhere within, this will become the root of the zipfile's directory structure

the directory
 * @param scene_file the scene file to make the zip file from
 * @param extract_folder the name of the folder created when the zip file is unzipped
 * @param zip_file out - the zip file that will be created
 * @param skip_missing any missing files will generate only warnings, and the zip file will be created anyway
 * @param write_scene_file rewrite the scene file before zipping, to store a new base path or fix extra '..'s in paths that might break
 *
 * @returns Parameter dictionary
 */
function zip_scene_file_params(
    directory: string | null,
    scene_file: string,
    extract_folder: string,
    zip_file: string,
    skip_missing: boolean = false,
    write_scene_file: boolean = false,
): ZipSceneFileParametersTagged {
    const params = {
        "@type": "workbench/zip-scene-file" as const,
        "skip-missing": skip_missing,
        "write-scene-file": write_scene_file,
        "scene-file": scene_file,
        "extract-folder": extract_folder,
        "zip-file": zip_file,
    };
    if (directory !== null) {
        params["directory"] = directory;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function zip_scene_file_cargs(
    params: ZipSceneFileParameters,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["directory"] ?? null) !== null || (params["skip-missing"] ?? false) || (params["write-scene-file"] ?? false)) {
        cargs.push(
            "wb_command",
            "-zip-scene-file",
            "-base-dir",
            (((params["directory"] ?? null) !== null) ? (params["directory"] ?? null) : ""),
            (((params["skip-missing"] ?? false)) ? "-skip-missing" : ""),
            (((params["write-scene-file"] ?? false)) ? "-write-scene-file" : "")
        );
    }
    cargs.push((params["scene-file"] ?? null));
    cargs.push((params["extract-folder"] ?? null));
    cargs.push((params["zip-file"] ?? null));
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function zip_scene_file_outputs(
    params: ZipSceneFileParameters,
    execution: Execution,
): ZipSceneFileOutputs {
    const ret: ZipSceneFileOutputs = {
        root: execution.outputFile("."),
    };
    return ret;
}


/**
 * ZIP A SCENE FILE AND ITS DATA FILES.
 *
 * If zip-file already exists, it will be overwritten.  If -base-dir is not specified, the base directory will be automatically set to the lowest level directory containing all files.  The scene file must contain only relative paths, and no data files may be outside the base directory.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `ZipSceneFileOutputs`).
 */
function zip_scene_file_execute(
    params: ZipSceneFileParameters,
    runner: Runner | null = null,
): ZipSceneFileOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(ZIP_SCENE_FILE_METADATA);
    params = execution.params(params)
    const cargs = zip_scene_file_cargs(params, execution)
    const ret = zip_scene_file_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * ZIP A SCENE FILE AND ITS DATA FILES.
 *
 * If zip-file already exists, it will be overwritten.  If -base-dir is not specified, the base directory will be automatically set to the lowest level directory containing all files.  The scene file must contain only relative paths, and no data files may be outside the base directory.
 *
 * @param directory specify a directory that all data files are somewhere within, this will become the root of the zipfile's directory structure

the directory
 * @param scene_file the scene file to make the zip file from
 * @param extract_folder the name of the folder created when the zip file is unzipped
 * @param zip_file out - the zip file that will be created
 * @param skip_missing any missing files will generate only warnings, and the zip file will be created anyway
 * @param write_scene_file rewrite the scene file before zipping, to store a new base path or fix extra '..'s in paths that might break
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `ZipSceneFileOutputs`).
 */
function zip_scene_file(
    directory: string | null,
    scene_file: string,
    extract_folder: string,
    zip_file: string,
    skip_missing: boolean = false,
    write_scene_file: boolean = false,
    runner: Runner | null = null,
): ZipSceneFileOutputs {
    const params = zip_scene_file_params(directory, scene_file, extract_folder, zip_file, skip_missing, write_scene_file)
    return zip_scene_file_execute(params, runner);
}


export {
      ZIP_SCENE_FILE_METADATA,
      ZipSceneFileOutputs,
      zip_scene_file,
      zip_scene_file_execute,
      zip_scene_file_params,
};
