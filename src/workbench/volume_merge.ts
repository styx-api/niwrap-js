// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const VOLUME_MERGE_METADATA: Metadata = {
    id: "fff7d7c8a2075faa5da5ccad34db6f9ba87459dd.workbench",
    name: "volume-merge",
    package: "workbench",
    container_image_tag: "nx10x/workbench:2.1.0",
};


interface VolumeMergeUpToParamsDict {
    "@type"?: "up-to";
    "last-subvol": string;
    "reverse": boolean;
}
type VolumeMergeUpToParamsDictTagged = Required<Pick<VolumeMergeUpToParamsDict, '@type'>> & VolumeMergeUpToParamsDict;


interface VolumeMergeSubvolumeParamsDict {
    "@type"?: "subvolume";
    "subvol": string;
    "up-to"?: VolumeMergeUpToParamsDict | null | undefined;
}
type VolumeMergeSubvolumeParamsDictTagged = Required<Pick<VolumeMergeSubvolumeParamsDict, '@type'>> & VolumeMergeSubvolumeParamsDict;


interface VolumeMergeVolumeParamsDict {
    "@type"?: "volume";
    "volume-in": InputPathType;
    "subvolume"?: Array<VolumeMergeSubvolumeParamsDict> | null | undefined;
}
type VolumeMergeVolumeParamsDictTagged = Required<Pick<VolumeMergeVolumeParamsDict, '@type'>> & VolumeMergeVolumeParamsDict;


interface VolumeMergeParamsDict {
    "@type"?: "workbench/volume-merge";
    "volume-out": string;
    "volume"?: Array<VolumeMergeVolumeParamsDict> | null | undefined;
}
type VolumeMergeParamsDictTagged = Required<Pick<VolumeMergeParamsDict, '@type'>> & VolumeMergeParamsDict;


/**
 * Build parameters.
 *
 * @param last_subvol the number or name of the last subvolume to include
 * @param reverse use the range in reverse order
 *
 * @returns Parameter dictionary
 */
function volume_merge_up_to(
    last_subvol: string,
    reverse: boolean = false,
): VolumeMergeUpToParamsDictTagged {
    const params = {
        "@type": "up-to" as const,
        "last-subvol": last_subvol,
        "reverse": reverse,
    };
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function volume_merge_up_to_cargs(
    params: VolumeMergeUpToParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "-up-to",
        (params["last-subvol"] ?? null)
    );
    if ((params["reverse"] ?? false)) {
        cargs.push("-reverse");
    }
    return cargs;
}


/**
 * Build parameters.
 *
 * @param subvol the subvolume number or name
 * @param up_to use an inclusive range of subvolumes
 *
 * @returns Parameter dictionary
 */
function volume_merge_subvolume(
    subvol: string,
    up_to: VolumeMergeUpToParamsDict | null = null,
): VolumeMergeSubvolumeParamsDictTagged {
    const params = {
        "@type": "subvolume" as const,
        "subvol": subvol,
    };
    if (up_to !== null) {
        params["up-to"] = up_to;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function volume_merge_subvolume_cargs(
    params: VolumeMergeSubvolumeParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "-subvolume",
        (params["subvol"] ?? null),
        ...(((params["up-to"] ?? null) !== null) ? volume_merge_up_to_cargs((params["up-to"] ?? null), execution) : [])
    );
    return cargs;
}


/**
 * Build parameters.
 *
 * @param volume_in a volume file to use subvolumes from
 * @param subvolume select a single subvolume to use
 *
 * @returns Parameter dictionary
 */
function volume_merge_volume(
    volume_in: InputPathType,
    subvolume: Array<VolumeMergeSubvolumeParamsDict> | null = null,
): VolumeMergeVolumeParamsDictTagged {
    const params = {
        "@type": "volume" as const,
        "volume-in": volume_in,
    };
    if (subvolume !== null) {
        params["subvolume"] = subvolume;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function volume_merge_volume_cargs(
    params: VolumeMergeVolumeParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "-volume",
        execution.inputFile((params["volume-in"] ?? null)),
        ...(((params["subvolume"] ?? null) !== null) ? (params["subvolume"] ?? null).map(s => volume_merge_subvolume_cargs(s, execution)).flat() : [])
    );
    return cargs;
}


/**
 * Output object returned when calling `VolumeMergeParamsDict(...)`.
 *
 * @interface
 */
interface VolumeMergeOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * the output volume file
     */
    volume_out: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param volume_out the output volume file
 * @param volume specify an input volume file
 *
 * @returns Parameter dictionary
 */
function volume_merge_params(
    volume_out: string,
    volume: Array<VolumeMergeVolumeParamsDict> | null = null,
): VolumeMergeParamsDictTagged {
    const params = {
        "@type": "workbench/volume-merge" as const,
        "volume-out": volume_out,
    };
    if (volume !== null) {
        params["volume"] = volume;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function volume_merge_cargs(
    params: VolumeMergeParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    cargs.push(
        "wb_command",
        "-volume-merge"
    );
    cargs.push((params["volume-out"] ?? null));
    if ((params["volume"] ?? null) !== null) {
        cargs.push(...(params["volume"] ?? null).map(s => volume_merge_volume_cargs(s, execution)).flat());
    }
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function volume_merge_outputs(
    params: VolumeMergeParamsDict,
    execution: Execution,
): VolumeMergeOutputs {
    const ret: VolumeMergeOutputs = {
        root: execution.outputFile("."),
        volume_out: execution.outputFile([(params["volume-out"] ?? null)].join('')),
    };
    return ret;
}


/**
 * MERGE VOLUME FILES INTO A NEW FILE.
 *
 * Takes one or more volume files and constructs a new volume file by concatenating subvolumes from them.  The input volume files must have the same volume space.
 *
 * Example: wb_command -volume-merge out.nii -volume first.nii -subvolume 1 -volume second.nii
 *
 * This example would take the first subvolume from first.nii, followed by all subvolumes from second.nii, and write these to out.nii.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `VolumeMergeOutputs`).
 */
function volume_merge_execute(
    params: VolumeMergeParamsDict,
    runner: Runner | null = null,
): VolumeMergeOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(VOLUME_MERGE_METADATA);
    params = execution.params(params)
    const cargs = volume_merge_cargs(params, execution)
    const ret = volume_merge_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * MERGE VOLUME FILES INTO A NEW FILE.
 *
 * Takes one or more volume files and constructs a new volume file by concatenating subvolumes from them.  The input volume files must have the same volume space.
 *
 * Example: wb_command -volume-merge out.nii -volume first.nii -subvolume 1 -volume second.nii
 *
 * This example would take the first subvolume from first.nii, followed by all subvolumes from second.nii, and write these to out.nii.
 *
 * @param volume_out the output volume file
 * @param volume specify an input volume file
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `VolumeMergeOutputs`).
 */
function volume_merge(
    volume_out: string,
    volume: Array<VolumeMergeVolumeParamsDict> | null = null,
    runner: Runner | null = null,
): VolumeMergeOutputs {
    const params = volume_merge_params(volume_out, volume)
    return volume_merge_execute(params, runner);
}


export {
      VOLUME_MERGE_METADATA,
      VolumeMergeOutputs,
      VolumeMergeParamsDict,
      VolumeMergeParamsDictTagged,
      VolumeMergeSubvolumeParamsDict,
      VolumeMergeSubvolumeParamsDictTagged,
      VolumeMergeUpToParamsDict,
      VolumeMergeUpToParamsDictTagged,
      VolumeMergeVolumeParamsDict,
      VolumeMergeVolumeParamsDictTagged,
      volume_merge,
      volume_merge_execute,
      volume_merge_params,
      volume_merge_subvolume,
      volume_merge_up_to,
      volume_merge_volume,
};
