// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const CREATE_SIGNED_DISTANCE_VOLUME_METADATA: Metadata = {
    id: "4d61fcbc40072b03f96c88c490ff99bbafba1379.workbench",
    name: "create-signed-distance-volume",
    package: "workbench",
};


interface CreateSignedDistanceVolumeParamsDict {
    "@type"?: "workbench/create-signed-distance-volume";
    "outvol": string;
    "roi-vol"?: string | null | undefined;
    "value"?: number | null | undefined;
    "dist"?: number | null | undefined;
    "dist"?: number | null | undefined;
    "num"?: number | null | undefined;
    "method"?: string | null | undefined;
    "surface": InputPathType;
    "refspace": string;
}
type CreateSignedDistanceVolumeParamsDictTagged = Required<Pick<CreateSignedDistanceVolumeParamsDict, '@type'>> & CreateSignedDistanceVolumeParamsDict;


/**
 * Output object returned when calling `CreateSignedDistanceVolumeParamsDict(...)`.
 *
 * @interface
 */
interface CreateSignedDistanceVolumeOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * the output volume
     */
    outvol: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param outvol the output volume
 * @param surface the input surface
 * @param refspace a volume in the desired output space (dims, spacing, origin)
 * @param roi_vol output an roi volume of where the output has a computed value

the output roi volume
 * @param value specify a value to put in all voxels that don't get assigned a distance

value to fill with (default 0)
 * @param dist specify distance for exact output

distance in mm (default 5)
 * @param dist_ specify distance for approximate output

distance in mm (default 20)
 * @param num voxel neighborhood for approximate calculation

size of neighborhood cube measured from center to face, in voxels (default 2 = 5x5x5)
 * @param method winding method for point inside surface test

name of the method (default EVEN_ODD)
 *
 * @returns Parameter dictionary
 */
function create_signed_distance_volume_params(
    outvol: string,
    surface: InputPathType,
    refspace: string,
    roi_vol: string | null = null,
    value: number | null = null,
    dist: number | null = null,
    dist_: number | null = null,
    num: number | null = null,
    method: string | null = null,
): CreateSignedDistanceVolumeParamsDictTagged {
    const params = {
        "@type": "workbench/create-signed-distance-volume" as const,
        "outvol": outvol,
        "surface": surface,
        "refspace": refspace,
    };
    if (roi_vol !== null) {
        params["roi-vol"] = roi_vol;
    }
    if (value !== null) {
        params["value"] = value;
    }
    if (dist !== null) {
        params["dist"] = dist;
    }
    if (dist_ !== null) {
        params["dist"] = dist_;
    }
    if (num !== null) {
        params["num"] = num;
    }
    if (method !== null) {
        params["method"] = method;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function create_signed_distance_volume_cargs(
    params: CreateSignedDistanceVolumeParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["roi-vol"] ?? null) !== null || (params["value"] ?? null) !== null || (params["dist"] ?? null) !== null || (params["dist"] ?? null) !== null || (params["num"] ?? null) !== null || (params["method"] ?? null) !== null) {
        cargs.push(
            "wb_command",
            "-create-signed-distance-volume",
            (params["outvol"] ?? null),
            "-roi-out",
            (((params["roi-vol"] ?? null) !== null) ? (params["roi-vol"] ?? null) : ""),
            "-fill-value",
            (((params["value"] ?? null) !== null) ? String((params["value"] ?? null)) : ""),
            "-exact-limit",
            (((params["dist"] ?? null) !== null) ? String((params["dist"] ?? null)) : ""),
            "-approx-limit",
            (((params["dist"] ?? null) !== null) ? String((params["dist"] ?? null)) : ""),
            "-approx-neighborhood",
            (((params["num"] ?? null) !== null) ? String((params["num"] ?? null)) : ""),
            "-winding",
            (((params["method"] ?? null) !== null) ? (params["method"] ?? null) : "")
        );
    }
    cargs.push(execution.inputFile((params["surface"] ?? null)));
    cargs.push((params["refspace"] ?? null));
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function create_signed_distance_volume_outputs(
    params: CreateSignedDistanceVolumeParamsDict,
    execution: Execution,
): CreateSignedDistanceVolumeOutputs {
    const ret: CreateSignedDistanceVolumeOutputs = {
        root: execution.outputFile("."),
        outvol: execution.outputFile([(params["outvol"] ?? null)].join('')),
    };
    return ret;
}


/**
 * CREATE SIGNED DISTANCE VOLUME FROM SURFACE.
 *
 * Computes the signed distance function of the surface.  Exact distance is calculated by finding the closest point on any surface triangle to the center of the voxel.  Approximate distance is calculated starting with these distances, using dijkstra's method with a neighborhood of voxels.  Specifying too small of an exact distance may produce unexpected results.  Valid specifiers for winding methods are as follows:
 *
 * EVEN_ODD (default)
 * NEGATIVE
 * NONZERO
 * NORMALS
 *
 * The NORMALS method uses the normals of triangles and edges, or the closest triangle hit by a ray from the point.  This method may be slightly faster, but is only reliable for a closed surface that does not cross through itself.  All other methods count entry (positive) and exit (negative) crossings of a vertical ray from the point, then counts as inside if the total is odd, negative, or nonzero, respectively.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CreateSignedDistanceVolumeOutputs`).
 */
function create_signed_distance_volume_execute(
    params: CreateSignedDistanceVolumeParamsDict,
    runner: Runner | null = null,
): CreateSignedDistanceVolumeOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(CREATE_SIGNED_DISTANCE_VOLUME_METADATA);
    params = execution.params(params)
    const cargs = create_signed_distance_volume_cargs(params, execution)
    const ret = create_signed_distance_volume_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * CREATE SIGNED DISTANCE VOLUME FROM SURFACE.
 *
 * Computes the signed distance function of the surface.  Exact distance is calculated by finding the closest point on any surface triangle to the center of the voxel.  Approximate distance is calculated starting with these distances, using dijkstra's method with a neighborhood of voxels.  Specifying too small of an exact distance may produce unexpected results.  Valid specifiers for winding methods are as follows:
 *
 * EVEN_ODD (default)
 * NEGATIVE
 * NONZERO
 * NORMALS
 *
 * The NORMALS method uses the normals of triangles and edges, or the closest triangle hit by a ray from the point.  This method may be slightly faster, but is only reliable for a closed surface that does not cross through itself.  All other methods count entry (positive) and exit (negative) crossings of a vertical ray from the point, then counts as inside if the total is odd, negative, or nonzero, respectively.
 *
 * @param outvol the output volume
 * @param surface the input surface
 * @param refspace a volume in the desired output space (dims, spacing, origin)
 * @param roi_vol output an roi volume of where the output has a computed value

the output roi volume
 * @param value specify a value to put in all voxels that don't get assigned a distance

value to fill with (default 0)
 * @param dist specify distance for exact output

distance in mm (default 5)
 * @param dist_ specify distance for approximate output

distance in mm (default 20)
 * @param num voxel neighborhood for approximate calculation

size of neighborhood cube measured from center to face, in voxels (default 2 = 5x5x5)
 * @param method winding method for point inside surface test

name of the method (default EVEN_ODD)
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `CreateSignedDistanceVolumeOutputs`).
 */
function create_signed_distance_volume(
    outvol: string,
    surface: InputPathType,
    refspace: string,
    roi_vol: string | null = null,
    value: number | null = null,
    dist: number | null = null,
    dist_: number | null = null,
    num: number | null = null,
    method: string | null = null,
    runner: Runner | null = null,
): CreateSignedDistanceVolumeOutputs {
    const params = create_signed_distance_volume_params(outvol, surface, refspace, roi_vol, value, dist, dist_, num, method)
    return create_signed_distance_volume_execute(params, runner);
}


export {
      CREATE_SIGNED_DISTANCE_VOLUME_METADATA,
      CreateSignedDistanceVolumeOutputs,
      CreateSignedDistanceVolumeParamsDict,
      CreateSignedDistanceVolumeParamsDictTagged,
      create_signed_distance_volume,
      create_signed_distance_volume_execute,
      create_signed_distance_volume_params,
};
