// This file was auto generated by Styx.
// Do not edit this file directly.

import { Runner, Execution, Metadata, InputPathType, OutputPathType, getGlobalRunner } from 'styxdefs';

const VOLUME_PARCEL_SMOOTHING_METADATA: Metadata = {
    id: "4531678f8f3118c9ec57f1efd95f5ab4ee4503d2.workbench",
    name: "volume-parcel-smoothing",
    package: "workbench",
    container_image_tag: "nx10x/workbench:2.1.0",
};


interface VolumeParcelSmoothingParamsDict {
    "@type"?: "workbench/volume-parcel-smoothing";
    "volume-out": string;
    "fwhm": boolean;
    "fix-zeros": boolean;
    "subvol"?: string | null | undefined;
    "data-volume": InputPathType;
    "label-volume": InputPathType;
    "kernel": number;
}
type VolumeParcelSmoothingParamsDictTagged = Required<Pick<VolumeParcelSmoothingParamsDict, '@type'>> & VolumeParcelSmoothingParamsDict;


/**
 * Output object returned when calling `VolumeParcelSmoothingParamsDict(...)`.
 *
 * @interface
 */
interface VolumeParcelSmoothingOutputs {
    /**
     * Output root folder. This is the root folder for all outputs.
     */
    root: OutputPathType;
    /**
     * the output volume
     */
    volume_out: OutputPathType;
}


/**
 * Build parameters.
 *
 * @param volume_out the output volume
 * @param data_volume the volume to smooth
 * @param label_volume a label volume containing the parcels to smooth
 * @param kernel the size of the gaussian smoothing kernel in mm, as sigma by default
 * @param fwhm smoothing kernel size is FWHM, not sigma
 * @param fix_zeros treat zero values as not being data
 * @param subvol select a single subvolume to smooth

the subvolume number or name
 *
 * @returns Parameter dictionary
 */
function volume_parcel_smoothing_params(
    volume_out: string,
    data_volume: InputPathType,
    label_volume: InputPathType,
    kernel: number,
    fwhm: boolean = false,
    fix_zeros: boolean = false,
    subvol: string | null = null,
): VolumeParcelSmoothingParamsDictTagged {
    const params = {
        "@type": "workbench/volume-parcel-smoothing" as const,
        "volume-out": volume_out,
        "fwhm": fwhm,
        "fix-zeros": fix_zeros,
        "data-volume": data_volume,
        "label-volume": label_volume,
        "kernel": kernel,
    };
    if (subvol !== null) {
        params["subvol"] = subvol;
    }
    return params;
}


/**
 * Build command-line arguments from parameters.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Command-line arguments.
 */
function volume_parcel_smoothing_cargs(
    params: VolumeParcelSmoothingParamsDict,
    execution: Execution,
): string[] {
    const cargs: string[] = [];
    if ((params["fwhm"] ?? false) || (params["fix-zeros"] ?? false) || (params["subvol"] ?? null) !== null) {
        cargs.push(
            "wb_command",
            "-volume-parcel-smoothing",
            (params["volume-out"] ?? null),
            (((params["fwhm"] ?? false)) ? "-fwhm" : ""),
            (((params["fix-zeros"] ?? false)) ? "-fix-zeros" : ""),
            ["-subvolume", (((params["subvol"] ?? null) !== null) ? (params["subvol"] ?? null) : "")].join('')
        );
    }
    cargs.push(execution.inputFile((params["data-volume"] ?? null)));
    cargs.push(execution.inputFile((params["label-volume"] ?? null)));
    cargs.push(String((params["kernel"] ?? null)));
    return cargs;
}


/**
 * Build outputs object containing output file paths and possibly stdout/stderr.
 *
 * @param params The parameters.
 * @param execution The execution object for resolving input paths.
 *
 * @returns Outputs object.
 */
function volume_parcel_smoothing_outputs(
    params: VolumeParcelSmoothingParamsDict,
    execution: Execution,
): VolumeParcelSmoothingOutputs {
    const ret: VolumeParcelSmoothingOutputs = {
        root: execution.outputFile("."),
        volume_out: execution.outputFile([(params["volume-out"] ?? null)].join('')),
    };
    return ret;
}


/**
 * SMOOTH PARCELS IN A VOLUME SEPARATELY.
 *
 * The volume is smoothed within each label in the label volume using data only from within the label.  Equivalent to running volume smoothing with ROIs matching each label separately, then adding the resulting volumes, but faster.
 *
 * @param params The parameters.
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `VolumeParcelSmoothingOutputs`).
 */
function volume_parcel_smoothing_execute(
    params: VolumeParcelSmoothingParamsDict,
    runner: Runner | null = null,
): VolumeParcelSmoothingOutputs {
    runner = runner || getGlobalRunner();
    const execution = runner.startExecution(VOLUME_PARCEL_SMOOTHING_METADATA);
    params = execution.params(params)
    const cargs = volume_parcel_smoothing_cargs(params, execution)
    const ret = volume_parcel_smoothing_outputs(params, execution)
    execution.run(cargs, undefined);
    return ret;
}


/**
 * SMOOTH PARCELS IN A VOLUME SEPARATELY.
 *
 * The volume is smoothed within each label in the label volume using data only from within the label.  Equivalent to running volume smoothing with ROIs matching each label separately, then adding the resulting volumes, but faster.
 *
 * @param volume_out the output volume
 * @param data_volume the volume to smooth
 * @param label_volume a label volume containing the parcels to smooth
 * @param kernel the size of the gaussian smoothing kernel in mm, as sigma by default
 * @param fwhm smoothing kernel size is FWHM, not sigma
 * @param fix_zeros treat zero values as not being data
 * @param subvol select a single subvolume to smooth

the subvolume number or name
 * @param runner Command runner
 *
 * @returns NamedTuple of outputs (described in `VolumeParcelSmoothingOutputs`).
 */
function volume_parcel_smoothing(
    volume_out: string,
    data_volume: InputPathType,
    label_volume: InputPathType,
    kernel: number,
    fwhm: boolean = false,
    fix_zeros: boolean = false,
    subvol: string | null = null,
    runner: Runner | null = null,
): VolumeParcelSmoothingOutputs {
    const params = volume_parcel_smoothing_params(volume_out, data_volume, label_volume, kernel, fwhm, fix_zeros, subvol)
    return volume_parcel_smoothing_execute(params, runner);
}


export {
      VOLUME_PARCEL_SMOOTHING_METADATA,
      VolumeParcelSmoothingOutputs,
      VolumeParcelSmoothingParamsDict,
      VolumeParcelSmoothingParamsDictTagged,
      volume_parcel_smoothing,
      volume_parcel_smoothing_execute,
      volume_parcel_smoothing_params,
};
